<!DOCTYPE html>
<!-- Created with https://packager.turbowarp.org/ -->
<html>
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <!-- We only include this to explicitly loosen the CSP of various packager environments. It does not provide any security. -->
  <meta http-equiv="Content-Security-Policy" content="default-src * 'self' 'unsafe-inline' 'unsafe-eval' data: blob:">
  <title>The World&apos;s State</title>
  <style>
    body {
      color: #ffffff;
      font-family: sans-serif;
      overflow: hidden;
      margin: 0;
      padding: 0;
    }
    :root, body.is-fullscreen {
      background-color: #000000;
    }
    [hidden] {
      display: none !important;
    }
    h1 {
      font-weight: normal;
    }
    a {
      color: inherit;
      text-decoration: underline;
      cursor: pointer;
    }

    #app, #loading, #error, #launch {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
    }
    .screen {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      text-align: center;
      cursor: default;
      user-select: none;
      -webkit-user-select: none;
      background-color: #000000;
    }
    #launch {
      background-color: rgba(0, 0, 0, 0.7);
      cursor: pointer;
    }
    .green-flag {
      width: 80px;
      height: 80px;
      padding: 16px;
      border-radius: 100%;
      background: rgba(255, 255, 255, 0.75);
      border: 3px solid hsla(0, 100%, 100%, 1);
      display: flex;
      justify-content: center;
      align-items: center;
      box-sizing: border-box;
    }
    #loading {
      
    }
    .progress-bar-outer {
      border: 1px solid currentColor;
      height: 10px;
      width: 200px;
      max-width: 200px;
    }
    .progress-bar-inner {
      height: 100%;
      width: 0;
      background-color: currentColor;
    }
    .loading-text, noscript {
      font-weight: normal;
      font-size: 36px;
      margin: 0 0 16px;
    }
    .loading-image {
      margin: 0 0 16px;
    }
    #error-message, #error-stack {
      font-family: monospace;
      max-width: 600px;
      white-space: pre-wrap;
      user-select: text;
      -webkit-user-select: text;
    }
    #error-stack {
      text-align: left;
      max-height: 200px;
      overflow: auto;
    }
    .control-button {
      width: 2rem;
      height: 2rem;
      padding: 0.375rem;
      margin-top: 0.5rem;
      margin-bottom: 0.5rem;
      user-select: none;
      -webkit-user-select: none;
      cursor: pointer;
      border: 0;
      border-radius: 4px;
    }
    .control-button-highlight:hover {
      background: #00000026;
    }
    .control-button-highlight.active {
      background: #00000059;
    }
    .fullscreen-button {
      background: white;
    }
    .standalone-fullscreen-button {
      position: absolute;
      top: 0;
      right: 0;
      background-color: rgba(0, 0, 0, 0.5);
      border-radius: 0 0 0 4px;
      padding: 4px;
      cursor: pointer;
    }
    .sc-canvas {
      cursor: auto;
    }
    .sc-monitor-root[data-opcode^="data_"] .sc-monitor-value-color {
      background-color: #ffffff;
    }
    .sc-monitor-row-value-outer {
      background-color: #fc662c;
    }
    .sc-monitor-row-value-editing .sc-monitor-row-value-outer {
      background-color: #e25b27;
    }
    
  </style>
  <meta name="theme-color" content="#000000">
  
</head>
<body>
  <div id="app"></div>

  <div id="launch" class="screen" hidden title="Click to start">
    <div class="green-flag">
      <svg viewBox="0 0 16.63 17.5" width="42" height="44">
        <defs><style>.cls-1,.cls-2{fill:#4cbf56;stroke:#45993d;stroke-linecap:round;stroke-linejoin:round;}.cls-2{stroke-width:1.5px;}</style></defs>
        <path class="cls-1" d="M.75,2A6.44,6.44,0,0,1,8.44,2h0a6.44,6.44,0,0,0,7.69,0V12.4a6.44,6.44,0,0,1-7.69,0h0a6.44,6.44,0,0,0-7.69,0"/>
        <line class="cls-2" x1="0.75" y1="16.75" x2="0.75" y2="0.75"/>
      </svg>
    </div>
  </div>

  <div id="loading" class="screen">
    <noscript>Enable JavaScript</noscript>
    
    
    
  </div>

  <div id="error" class="screen" hidden>
    <h1>Error</h1>
    <details>
      <summary id="error-message"></summary>
      <p id="error-stack"></p>
    </details>
  </div>

  <script src="script.js"></script>
  <script>
    const appElement = document.getElementById('app');
    const launchScreen = document.getElementById('launch');
    const loadingScreen = document.getElementById('loading');
    const loadingInner = document.getElementById('loading-inner');
    const errorScreen = document.getElementById('error');
    const errorScreenMessage = document.getElementById('error-message');
    const errorScreenStack = document.getElementById('error-stack');

    const handleError = (error) => {
      console.error(error);
      if (!errorScreen.hidden) return;
      errorScreen.hidden = false;
      errorScreenMessage.textContent = '' + error;
      let debug = error && error.stack || 'no stack';
      debug += '\nUser agent: ' + navigator.userAgent;
      errorScreenStack.textContent = debug;
    };
    const setProgress = (progress) => {
      if (loadingInner) loadingInner.style.width = progress * 100 + '%';
    };
    const interpolate = (a, b, t) => a + t * (b - a);

    try {
      setProgress(0.1);

      const scaffolding = new Scaffolding.Scaffolding();
      scaffolding.width = 480;
      scaffolding.height = 100;
      scaffolding.resizeMode = "dynamic-resize";
      scaffolding.editableLists = false;
      scaffolding.usePackagedRuntime = true;
      scaffolding.setup();
      scaffolding.appendTo(appElement);

      const vm = scaffolding.vm;
      window.scaffolding = scaffolding;
      window.vm = scaffolding.vm;
      window.Scratch = {
        vm,
        renderer: vm.renderer,
        audioEngine: vm.runtime.audioEngine,
        bitmapAdapter: vm.runtime.v2BitmapAdapter,
        videoProvider: vm.runtime.ioDevices.video.provider
      };

      scaffolding.setUsername("player####".replace(/#/g, () => Math.floor(Math.random() * 10)));
      scaffolding.setAccentColor("#000000");

      try {
        scaffolding.addCloudProvider(new Scaffolding.Cloud.WebSocketProvider(["wss://clouddata.turbowarp.org","wss://clouddata.turbowarp.xyz"], "p4-@Project.sb3"));
      } catch (error) {
        console.error(error);
      }

      vm.setTurboMode(false);
      if (vm.setInterpolation) vm.setInterpolation(false);
      if (vm.setFramerate) vm.setFramerate(1);
      if (vm.renderer.setUseHighQualityRender) vm.renderer.setUseHighQualityRender(false);
      if (vm.setRuntimeOptions) vm.setRuntimeOptions({
        fencing: true,
        miscLimits: true,
        maxClones: 300,
      });
      if (vm.setCompilerOptions) vm.setCompilerOptions({
        enabled: false,
        warpTimer: false
      });
      if (vm.renderer.setMaxTextureDimension) vm.renderer.setMaxTextureDimension(2048);

      // enforcePrivacy threat model only makes sense in the editor
      if (vm.runtime.setEnforcePrivacy) vm.runtime.setEnforcePrivacy(false);

      if (typeof ScaffoldingAddons !== 'undefined') {
        ScaffoldingAddons.run(scaffolding, {"gamepad":false,"pointerlock":false,"specialCloudBehaviors":false,"unsafeCloudBehaviors":false,"pause":false});
      }

      scaffolding.setExtensionSecurityManager({
        getSandboxMode: () => 'unsandboxed',
        canLoadExtensionFromProject: () => true
      });
      for (const extension of ["data:text/javascript;base64,Ly8gTmFtZTogTW9yZSBFdmVudHMKLy8gSUQ6IGxtc01vcmVFdmVudHMKLy8gRGVzY3JpcHRpb246IFN0YXJ0IHlvdXIgc2NyaXB0cyBpbiBuZXcgd2F5cy4KLy8gQnk6IExpbHlNYWtlc1RoaW5ncyA8aHR0cHM6Ly9zY3JhdGNoLm1pdC5lZHUvdXNlcnMvTGlseU1ha2VzVGhpbmdzLz4KLy8gTGljZW5zZTogTUlUIEFORCBMR1BMLTMuMAoKKGZ1bmN0aW9uIChTY3JhdGNoKSB7CiAgInVzZSBzdHJpY3QiOwoKICBjb25zdCB2bSA9IFNjcmF0Y2gudm07CiAgY29uc3QgcnVudGltZSA9IHZtLnJ1bnRpbWU7CgogIGNvbnN0IHN0b3BJY29uID0KICAgICJkYXRhOmltYWdlL3BuZztiYXNlNjQsaVZCT1J3MEtHZ29BQUFBTlNVaEVVZ0FBQURJQUFBQXlDQU1BQUFBcDRYaURBQUFBUWxCTVZFVUFBQUMvVUZDOFEwT3pUVTI0U0VpNFNFaTNTRWk0UjBlNFNFaTRTRWk0U0VpNFNFaTdTVW04U1VuTVRrN01UMC9PVDAvUFQwL2dWVlhpVlZYc1dWbi8vLytDb09kMkFBQUFDM1JTVGxNQUVCTVV1N3pMejlEOC9kSVhuSndBQUFBQllrdEhSQlhsMlBtakFBQUF4a2xFUVZSSXgrM1d3UktESUJBRDBKV3FWRU90V3Y3L1czdHdPcUt3RUx6VzNOOXdZaE9STU1ZaXp0Z1pVWk1VQUt4cW1oNUtuby9NRzI1Nm56STU5WjJtQitCV0grWHpVdDVSaFdveVFqRlprVFFGa1RCRkVSbENuQXdsRG9ZVWdhSEZibHBhZUw4NkFLME12TmpNSUFCbVQyY0dJQUFXbml3M3VjbS9rOW92ZHVFalh6Z1h0VWZKbXRyVHQ5Vlp6WUg5RlNCL3h2ZktaTXNpTEZtdWtvNjF6QlRmdWNqTDlScFhmNm5FVTJNaFB4WFM4Nkora09SbWp6NlY2c2VWaU9uRzhvVDdBcE1janNZWndoWENBQUFBQUVsRlRrU3VRbUNDIjsKCiAgLy8gU291cmNlOgogIC8vIGh0dHBzOi8vZ2l0aHViLmNvbS9UdXJib1dhcnAvc2NyYXRjaC12bS9ibG9iL2RldmVsb3Avc3JjL2lvL2tleWJvYXJkLmpzCiAgLy8gaHR0cHM6Ly9naXRodWIuY29tL1R1cmJvV2FycC9zY3JhdGNoLWJsb2Nrcy9ibG9iL2RldmVsb3AvYmxvY2tzX3ZlcnRpY2FsL2V2ZW50LmpzCiAgY29uc3QgdmFsaWRLZXlib2FyZElucHV0cyA9IFsKICAgIC8vIFNwZWNpYWwgSW5wdXRzCiAgICB7IHRleHQ6ICJzcGFjZSIsIHZhbHVlOiAic3BhY2UiIH0sCiAgICB7IHRleHQ6ICJ1cCBhcnJvdyIsIHZhbHVlOiAidXAgYXJyb3ciIH0sCiAgICB7IHRleHQ6ICJkb3duIGFycm93IiwgdmFsdWU6ICJkb3duIGFycm93IiB9LAogICAgeyB0ZXh0OiAicmlnaHQgYXJyb3ciLCB2YWx1ZTogInJpZ2h0IGFycm93IiB9LAogICAgeyB0ZXh0OiAibGVmdCBhcnJvdyIsIHZhbHVlOiAibGVmdCBhcnJvdyIgfSwKICAgIHsgdGV4dDogImVudGVyIiwgdmFsdWU6ICJlbnRlciIgfSwKICAgIC8vIFRXOiBFeHRyYSBTcGVjaWFsIElucHV0cwogICAgeyB0ZXh0OiAiYmFja3NwYWNlIiwgdmFsdWU6ICJiYWNrc3BhY2UiIH0sCiAgICB7IHRleHQ6ICJkZWxldGUiLCB2YWx1ZTogImRlbGV0ZSIgfSwKICAgIHsgdGV4dDogInNoaWZ0IiwgdmFsdWU6ICJzaGlmdCIgfSwKICAgIHsgdGV4dDogImNhcHMgbG9jayIsIHZhbHVlOiAiY2FwcyBsb2NrIiB9LAogICAgeyB0ZXh0OiAic2Nyb2xsIGxvY2siLCB2YWx1ZTogInNjcm9sbCBsb2NrIiB9LAogICAgeyB0ZXh0OiAiY29udHJvbCIsIHZhbHVlOiAiY29udHJvbCIgfSwKICAgIHsgdGV4dDogImVzY2FwZSIsIHZhbHVlOiAiZXNjYXBlIiB9LAogICAgeyB0ZXh0OiAiaW5zZXJ0IiwgdmFsdWU6ICJpbnNlcnQiIH0sCiAgICB7IHRleHQ6ICJob21lIiwgdmFsdWU6ICJob21lIiB9LAogICAgeyB0ZXh0OiAiZW5kIiwgdmFsdWU6ICJlbmQiIH0sCiAgICB7IHRleHQ6ICJwYWdlIHVwIiwgdmFsdWU6ICJwYWdlIHVwIiB9LAogICAgeyB0ZXh0OiAicGFnZSBkb3duIiwgdmFsdWU6ICJwYWdlIGRvd24iIH0sCiAgICAvLyBMZXR0ZXIgS2V5Ym9hcmQgSW5wdXRzCiAgICB7IHRleHQ6ICJhIiwgdmFsdWU6ICJhIiB9LAogICAgeyB0ZXh0OiAiYiIsIHZhbHVlOiAiYiIgfSwKICAgIHsgdGV4dDogImMiLCB2YWx1ZTogImMiIH0sCiAgICB7IHRleHQ6ICJkIiwgdmFsdWU6ICJkIiB9LAogICAgeyB0ZXh0OiAiZSIsIHZhbHVlOiAiZSIgfSwKICAgIHsgdGV4dDogImYiLCB2YWx1ZTogImYiIH0sCiAgICB7IHRleHQ6ICJnIiwgdmFsdWU6ICJnIiB9LAogICAgeyB0ZXh0OiAiaCIsIHZhbHVlOiAiaCIgfSwKICAgIHsgdGV4dDogImkiLCB2YWx1ZTogImkiIH0sCiAgICB7IHRleHQ6ICJqIiwgdmFsdWU6ICJqIiB9LAogICAgeyB0ZXh0OiAiayIsIHZhbHVlOiAiayIgfSwKICAgIHsgdGV4dDogImwiLCB2YWx1ZTogImwiIH0sCiAgICB7IHRleHQ6ICJtIiwgdmFsdWU6ICJtIiB9LAogICAgeyB0ZXh0OiAibiIsIHZhbHVlOiAibiIgfSwKICAgIHsgdGV4dDogIm8iLCB2YWx1ZTogIm8iIH0sCiAgICB7IHRleHQ6ICJwIiwgdmFsdWU6ICJwIiB9LAogICAgeyB0ZXh0OiAicSIsIHZhbHVlOiAicSIgfSwKICAgIHsgdGV4dDogInIiLCB2YWx1ZTogInIiIH0sCiAgICB7IHRleHQ6ICJzIiwgdmFsdWU6ICJzIiB9LAogICAgeyB0ZXh0OiAidCIsIHZhbHVlOiAidCIgfSwKICAgIHsgdGV4dDogInUiLCB2YWx1ZTogInUiIH0sCiAgICB7IHRleHQ6ICJ2IiwgdmFsdWU6ICJ2IiB9LAogICAgeyB0ZXh0OiAidyIsIHZhbHVlOiAidyIgfSwKICAgIHsgdGV4dDogIngiLCB2YWx1ZTogIngiIH0sCiAgICB7IHRleHQ6ICJ5IiwgdmFsdWU6ICJ5IiB9LAogICAgeyB0ZXh0OiAieiIsIHZhbHVlOiAieiIgfSwKICAgIC8vIE51bWJlciBLZXlib2FyZCBJbnB1dHMKICAgIHsgdGV4dDogIjAiLCB2YWx1ZTogIjAiIH0sCiAgICB7IHRleHQ6ICIxIiwgdmFsdWU6ICIxIiB9LAogICAgeyB0ZXh0OiAiMiIsIHZhbHVlOiAiMiIgfSwKICAgIHsgdGV4dDogIjMiLCB2YWx1ZTogIjMiIH0sCiAgICB7IHRleHQ6ICI0IiwgdmFsdWU6ICI0IiB9LAogICAgeyB0ZXh0OiAiNSIsIHZhbHVlOiAiNSIgfSwKICAgIHsgdGV4dDogIjYiLCB2YWx1ZTogIjYiIH0sCiAgICB7IHRleHQ6ICI3IiwgdmFsdWU6ICI3IiB9LAogICAgeyB0ZXh0OiAiOCIsIHZhbHVlOiAiOCIgfSwKICAgIHsgdGV4dDogIjkiLCB2YWx1ZTogIjkiIH0sCiAgXTsKCiAgdmFyIGxhc3RWYWx1ZXMgPSB7fTsKICB2YXIgcnVuVGltZXIgPSAwOwoKICBjb25zdCBNQVhfQkVGT1JFX1NBVkVfTVMgPSAzMDAwOwoKICBjb25zdCBiZWZvcmVTYXZlID0gKCkgPT4KICAgIG5ldyBQcm9taXNlKChyZXNvbHZlKSA9PiB7CiAgICAgIGNvbnN0IHRocmVhZHMgPSB2bS5ydW50aW1lLnN0YXJ0SGF0cygibG1zTW9yZUV2ZW50c19iZWZvcmVTYXZlIik7CgogICAgICBpZiAodGhyZWFkcy5sZW5ndGggPT09IDApIHsKICAgICAgICByZXNvbHZlKCk7CiAgICAgICAgcmV0dXJuOwogICAgICB9CgogICAgICBjb25zdCBzdGFydFRpbWUgPSBwZXJmb3JtYW5jZS5ub3coKTsKICAgICAgY29uc3QgY2hlY2tUaHJlYWRTdGF0dXMgPSAoKSA9PiB7CiAgICAgICAgaWYgKAogICAgICAgICAgcGVyZm9ybWFuY2Uubm93KCkgLSBzdGFydFRpbWUgPiBNQVhfQkVGT1JFX1NBVkVfTVMgfHwKICAgICAgICAgIHRocmVhZHMuZXZlcnkoKHRocmVhZCkgPT4gIXZtLnJ1bnRpbWUuaXNBY3RpdmVUaHJlYWQodGhyZWFkKSkKICAgICAgICApIHsKICAgICAgICAgIHZtLnJ1bnRpbWUub2ZmKCJBRlRFUl9FWEVDVVRFIiwgY2hlY2tUaHJlYWRTdGF0dXMpOwogICAgICAgICAgcmVzb2x2ZSgpOwogICAgICAgIH0KICAgICAgfTsKCiAgICAgIHZtLnJ1bnRpbWUub24oIkFGVEVSX0VYRUNVVEUiLCBjaGVja1RocmVhZFN0YXR1cyk7CiAgICB9KTsKCiAgY29uc3QgYWZ0ZXJTYXZlID0gKCkgPT4gewogICAgLy8gV2FpdCB1bnRpbCB0aGUgbmV4dCBmcmFtZSBhY3R1YWxseSBzdGFydHMgc28gdGhhdCB0aGUgYWN0dWFsIGZpbGUKICAgIC8vIHNhdmluZyByb3V0aW5lIGhhcyBhIGNoYW5jZSB0byBmaW5pc2ggYmVmb3JlIHdlIHN0YXJ0aW5nIHJ1bm5pbmcgYmxvY2tzLgogICAgdm0ucnVudGltZS5vbmNlKCJCRUZPUkVfRVhFQ1VURSIsICgpID0+IHsKICAgICAgdm0ucnVudGltZS5zdGFydEhhdHMoImxtc01vcmVFdmVudHNfYWZ0ZXJTYXZlIik7CiAgICB9KTsKICB9OwoKICBjb25zdCBvcmlnaW5hbFNhdmVQcm9qZWN0U2IzID0gdm0uc2F2ZVByb2plY3RTYjM7CiAgdm0uc2F2ZVByb2plY3RTYjMgPSBhc3luYyBmdW5jdGlvbiAoLi4uYXJncykgewogICAgYXdhaXQgYmVmb3JlU2F2ZSgpOwogICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgb3JpZ2luYWxTYXZlUHJvamVjdFNiMy5hcHBseSh0aGlzLCBhcmdzKTsKICAgIGFmdGVyU2F2ZSgpOwogICAgcmV0dXJuIHJlc3VsdDsKICB9OwoKICBjb25zdCBvcmlnaW5hbFNhdmVQcm9qZWN0U2IzU3RyZWFtID0gdm0uc2F2ZVByb2plY3RTYjNTdHJlYW07CiAgdm0uc2F2ZVByb2plY3RTYjNTdHJlYW0gPSBmdW5jdGlvbiAoLi4uYXJncykgewogICAgLy8gVGhpcyBpcyBjb21wbGljYXRlZCBiZWNhdXNlIHdlIG5lZWQgdG8gcmV0dXJuIGEgc3RyZWFtIG9iamVjdCBzeW5jcm9ub3VzbHkuLi4KCiAgICBsZXQgcmVhbFN0cmVhbSA9IG51bGw7CiAgICBjb25zdCBxdWV1ZWRDYWxscyA9IFtdOwoKICAgIGNvbnN0IHdoZW5TdHJlYW1SZWFkeSA9IChtZXRob2ROYW1lLCBhcmdzKSA9PiB7CiAgICAgIGlmIChyZWFsU3RyZWFtKSB7CiAgICAgICAgcmV0dXJuIHJlYWxTdHJlYW1bbWV0aG9kTmFtZV0uYXBwbHkocmVhbFN0cmVhbSwgYXJncyk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlKSA9PiB7CiAgICAgICAgICBxdWV1ZWRDYWxscy5wdXNoKHsKICAgICAgICAgICAgcmVzb2x2ZSwKICAgICAgICAgICAgbWV0aG9kTmFtZSwKICAgICAgICAgICAgYXJncywKICAgICAgICAgIH0pOwogICAgICAgIH0pOwogICAgICB9CiAgICB9OwoKICAgIGNvbnN0IHN0cmVhbVdyYXBwZXIgPSB7CiAgICAgIG9uOiAoLi4uYXJncykgPT4gdm9pZCB3aGVuU3RyZWFtUmVhZHkoIm9uIiwgYXJncyksCiAgICAgIHBhdXNlOiAoLi4uYXJncykgPT4gdm9pZCB3aGVuU3RyZWFtUmVhZHkoInBhdXNlIiwgYXJncyksCiAgICAgIHJlc3VtZTogKC4uLmFyZ3MpID0+IHZvaWQgd2hlblN0cmVhbVJlYWR5KCJyZXN1bWUiLCBhcmdzKSwKICAgICAgYWNjdW11bGF0ZTogKC4uLmFyZ3MpID0+IHdoZW5TdHJlYW1SZWFkeSgiYWNjdW11bGF0ZSIsIGFyZ3MpLAogICAgfTsKCiAgICBiZWZvcmVTYXZlKCkudGhlbigoKSA9PiB7CiAgICAgIHJlYWxTdHJlYW0gPSBvcmlnaW5hbFNhdmVQcm9qZWN0U2IzU3RyZWFtLmFwcGx5KHRoaXMsIGFyZ3MpOwoKICAgICAgcmVhbFN0cmVhbS5vbigiZW5kIiwgKCkgPT4gewogICAgICAgIC8vIE5vdCBzdXJlIGhvdyBKU1ppcCBoYW5kbGVzIGVycm9ycyBoZXJlLCBzbyB3ZSdsbCBtYWtlIHN1cmUgbm90IHRvIGJyZWFrIGFueXRoaW5nIGlmCiAgICAgICAgLy8gYWZ0ZXJTYXZlIHNvbWVob3cgdGhyb3dzCiAgICAgICAgdHJ5IHsKICAgICAgICAgIGFmdGVyU2F2ZSgpOwogICAgICAgIH0gY2F0Y2ggKGUpIHsKICAgICAgICAgIGNvbnNvbGUuZXJyb3IoZSk7CiAgICAgICAgfQogICAgICB9KTsKCiAgICAgIGZvciAoY29uc3QgcXVldWVkIG9mIHF1ZXVlZENhbGxzKSB7CiAgICAgICAgcXVldWVkLnJlc29sdmUoCiAgICAgICAgICByZWFsU3RyZWFtW3F1ZXVlZC5tZXRob2ROYW1lXS5hcHBseShyZWFsU3RyZWFtLCBxdWV1ZWQuYXJncykKICAgICAgICApOwogICAgICB9CiAgICAgIHF1ZXVlZENhbGxzLmxlbmd0aCA9IDA7CiAgICB9KTsKCiAgICByZXR1cm4gc3RyZWFtV3JhcHBlcjsKICB9OwoKICBjbGFzcyBNb3JlRXZlbnRzIHsKICAgIGNvbnN0cnVjdG9yKCkgewogICAgICAvLyBTdG9wIFNpZ24gQ2xpY2tlZCBjb250cmlidXRlZCBieSBAQ1NUMTIyOQogICAgICBydW50aW1lLnNob3VsZEV4ZWN1dGVTdG9wQ2xpY2tlZCA9IHRydWU7CiAgICAgIHJ1bnRpbWUub24oIkJFRk9SRV9FWEVDVVRFIiwgKCkgPT4gewogICAgICAgIHJ1blRpbWVyKys7CiAgICAgICAgcnVudGltZS5zaG91bGRFeGVjdXRlU3RvcENsaWNrZWQgPSBmYWxzZTsKCiAgICAgICAgcnVudGltZS5zdGFydEhhdHMoImxtc01vcmVFdmVudHNfZm9yZXZlciIpOwogICAgICAgIHJ1bnRpbWUuc3RhcnRIYXRzKCJsbXNNb3JlRXZlbnRzX3doaWxlVHJ1ZUZhbHNlIik7CiAgICAgICAgcnVudGltZS5zdGFydEhhdHMoImxtc01vcmVFdmVudHNfd2hlblZhbHVlQ2hhbmdlZCIpOwogICAgICAgIHJ1bnRpbWUuc3RhcnRIYXRzKCJsbXNNb3JlRXZlbnRzX2V2ZXJ5RHVyYXRpb24iKTsKICAgICAgICBydW50aW1lLnN0YXJ0SGF0cygibG1zTW9yZUV2ZW50c193aGlsZUtleVByZXNzZWQiKTsKICAgICAgfSk7CiAgICAgIHJ1bnRpbWUub24oIlBST0pFQ1RfU1RBUlQiLCAoKSA9PiB7CiAgICAgICAgcnVuVGltZXIgPSAwOwogICAgICB9KTsKICAgICAgcnVudGltZS5vbigiUFJPSkVDVF9TVE9QX0FMTCIsICgpID0+IHsKICAgICAgICBydW5UaW1lciA9IDA7CiAgICAgICAgaWYgKHJ1bnRpbWUuc2hvdWxkRXhlY3V0ZVN0b3BDbGlja2VkKQogICAgICAgICAgcXVldWVNaWNyb3Rhc2soKCkgPT4KICAgICAgICAgICAgcnVudGltZS5zdGFydEhhdHMoImxtc01vcmVFdmVudHNfd2hlblN0b3BDbGlja2VkIikKICAgICAgICAgICk7CiAgICAgIH0pOwogICAgICBydW50aW1lLm9uKCJBRlRFUl9FWEVDVVRFIiwgKCkgPT4gewogICAgICAgIHJ1bnRpbWUuc2hvdWxkRXhlY3V0ZVN0b3BDbGlja2VkID0gdHJ1ZTsKICAgICAgfSk7CiAgICAgIGNvbnN0IG9yaWdpbmFsR3JlZW5GbGFnID0gdm0uZ3JlZW5GbGFnOwogICAgICB2bS5ncmVlbkZsYWcgPSBmdW5jdGlvbiAoKSB7CiAgICAgICAgcnVudGltZS5zaG91bGRFeGVjdXRlU3RvcENsaWNrZWQgPSBmYWxzZTsKICAgICAgICBvcmlnaW5hbEdyZWVuRmxhZy5jYWxsKHRoaXMpOwogICAgICB9OwogICAgfQoKICAgIGdldEluZm8oKSB7CiAgICAgIHJldHVybiB7CiAgICAgICAgaWQ6ICJsbXNNb3JlRXZlbnRzIiwKICAgICAgICBuYW1lOiBTY3JhdGNoLnRyYW5zbGF0ZSgiTW9yZSBFdmVudHMiKSwKICAgICAgICBjb2xvcjE6ICIjRkZCRjAwIiwKICAgICAgICBjb2xvcjI6ICIjRTZBQzAwIiwKICAgICAgICBjb2xvcjM6ICIjQ0M5OTAwIiwKICAgICAgICBibG9ja3M6IFsKICAgICAgICAgIHsKICAgICAgICAgICAgb3Bjb2RlOiAid2hlblN0b3BDbGlja2VkIiwKICAgICAgICAgICAgYmxvY2tUeXBlOiBTY3JhdGNoLkJsb2NrVHlwZS5FVkVOVCwKICAgICAgICAgICAgdGV4dDogU2NyYXRjaC50cmFuc2xhdGUoIndoZW4gW1NUT1BdIGNsaWNrZWQiKSwKICAgICAgICAgICAgaXNFZGdlQWN0aXZhdGVkOiBmYWxzZSwKICAgICAgICAgICAgYXJndW1lbnRzOiB7CiAgICAgICAgICAgICAgU1RPUDogewogICAgICAgICAgICAgICAgdHlwZTogU2NyYXRjaC5Bcmd1bWVudFR5cGUuSU1BR0UsCiAgICAgICAgICAgICAgICBkYXRhVVJJOiBzdG9wSWNvbiwKICAgICAgICAgICAgICB9LAogICAgICAgICAgICB9LAogICAgICAgICAgICBleHRlbnNpb25zOiBbImNvbG91cnNfZXZlbnQiXSwKICAgICAgICAgIH0sCiAgICAgICAgICB7CiAgICAgICAgICAgIG9wY29kZTogImZvcmV2ZXIiLAogICAgICAgICAgICBibG9ja1R5cGU6IFNjcmF0Y2guQmxvY2tUeXBlLkVWRU5ULAogICAgICAgICAgICB0ZXh0OiBTY3JhdGNoLnRyYW5zbGF0ZSgiZm9yZXZlciIpLAogICAgICAgICAgICBpc0VkZ2VBY3RpdmF0ZWQ6IGZhbHNlLAogICAgICAgICAgICBleHRlbnNpb25zOiBbImNvbG91cnNfZXZlbnQiXSwKICAgICAgICAgIH0sCgogICAgICAgICAgIi0tLSIsCgogICAgICAgICAgewogICAgICAgICAgICBvcGNvZGU6ICJ3aGVuVHJ1ZUZhbHNlIiwKICAgICAgICAgICAgYmxvY2tUeXBlOiBTY3JhdGNoLkJsb2NrVHlwZS5IQVQsCiAgICAgICAgICAgIHRleHQ6IFNjcmF0Y2gudHJhbnNsYXRlKCJ3aGVuIFtDT05ESVRJT05dIGJlY29tZXMgW1NUQVRFXSIpLAogICAgICAgICAgICBpc0VkZ2VBY3RpdmF0ZWQ6IHRydWUsCiAgICAgICAgICAgIGFyZ3VtZW50czogewogICAgICAgICAgICAgIENPTkRJVElPTjogewogICAgICAgICAgICAgICAgdHlwZTogU2NyYXRjaC5Bcmd1bWVudFR5cGUuQk9PTEVBTiwKICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgIFNUQVRFOiB7CiAgICAgICAgICAgICAgICB0eXBlOiBTY3JhdGNoLkFyZ3VtZW50VHlwZS5TVFJJTkcsCiAgICAgICAgICAgICAgICBtZW51OiAiYm9vbGVhbiIsCiAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgfSwKICAgICAgICAgICAgZXh0ZW5zaW9uczogWyJjb2xvdXJzX2V2ZW50Il0sCiAgICAgICAgICB9LAogICAgICAgICAgewogICAgICAgICAgICBvcGNvZGU6ICJ3aGlsZVRydWVGYWxzZSIsCiAgICAgICAgICAgIGJsb2NrVHlwZTogU2NyYXRjaC5CbG9ja1R5cGUuSEFULAogICAgICAgICAgICB0ZXh0OiBTY3JhdGNoLnRyYW5zbGF0ZSgid2hpbGUgW0NPTkRJVElPTl0gaXMgW1NUQVRFXSIpLAogICAgICAgICAgICBpc0VkZ2VBY3RpdmF0ZWQ6IGZhbHNlLAogICAgICAgICAgICBhcmd1bWVudHM6IHsKICAgICAgICAgICAgICBDT05ESVRJT046IHsKICAgICAgICAgICAgICAgIHR5cGU6IFNjcmF0Y2guQXJndW1lbnRUeXBlLkJPT0xFQU4sCiAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICBTVEFURTogewogICAgICAgICAgICAgICAgdHlwZTogU2NyYXRjaC5Bcmd1bWVudFR5cGUuU1RSSU5HLAogICAgICAgICAgICAgICAgbWVudTogImJvb2xlYW4iLAogICAgICAgICAgICAgIH0sCiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIGV4dGVuc2lvbnM6IFsiY29sb3Vyc19ldmVudCJdLAogICAgICAgICAgfSwKCiAgICAgICAgICAiLS0tIiwKCiAgICAgICAgICB7CiAgICAgICAgICAgIG9wY29kZTogIndoZW5WYWx1ZUNoYW5nZWQiLAogICAgICAgICAgICBibG9ja1R5cGU6IFNjcmF0Y2guQmxvY2tUeXBlLkhBVCwKICAgICAgICAgICAgdGV4dDogU2NyYXRjaC50cmFuc2xhdGUoIndoZW4gW0lOUFVUXSBpcyBjaGFuZ2VkIiksCiAgICAgICAgICAgIGlzRWRnZUFjdGl2YXRlZDogZmFsc2UsCiAgICAgICAgICAgIGFyZ3VtZW50czogewogICAgICAgICAgICAgIElOUFVUOiB7CiAgICAgICAgICAgICAgICAvLyBJbnRlbnRpb25hbDoKICAgICAgICAgICAgICAgIC8vIEVuY291cmFnZXMgcGVvcGxlIHRvIHBsYWNlIGEgYmxvY2sKICAgICAgICAgICAgICAgIC8vIChhcyBvcHBvc2VkIHRvIHR5cGluZyBhIHZhbHVlKQogICAgICAgICAgICAgICAgdHlwZTogbnVsbCwKICAgICAgICAgICAgICB9LAogICAgICAgICAgICB9LAogICAgICAgICAgICBleHRlbnNpb25zOiBbImNvbG91cnNfZXZlbnQiXSwKICAgICAgICAgIH0sCiAgICAgICAgICB7CiAgICAgICAgICAgIG9wY29kZTogImV2ZXJ5RHVyYXRpb24iLAogICAgICAgICAgICBibG9ja1R5cGU6IFNjcmF0Y2guQmxvY2tUeXBlLkhBVCwKICAgICAgICAgICAgdGV4dDogU2NyYXRjaC50cmFuc2xhdGUoImV2ZXJ5IFtEVVJBVElPTl0gZnJhbWVzIiksCiAgICAgICAgICAgIGlzRWRnZUFjdGl2YXRlZDogZmFsc2UsCiAgICAgICAgICAgIGFyZ3VtZW50czogewogICAgICAgICAgICAgIERVUkFUSU9OOiB7CiAgICAgICAgICAgICAgICB0eXBlOiBTY3JhdGNoLkFyZ3VtZW50VHlwZS5OVU1CRVIsCiAgICAgICAgICAgICAgICBkZWZhdWx0VmFsdWU6IDMsCiAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgfSwKICAgICAgICAgICAgZXh0ZW5zaW9uczogWyJjb2xvdXJzX2V2ZW50Il0sCiAgICAgICAgICB9LAoKICAgICAgICAgICItLS0iLAoKICAgICAgICAgIHsKICAgICAgICAgICAgb3Bjb2RlOiAid2hlbktleUFjdGlvbiIsCiAgICAgICAgICAgIGJsb2NrVHlwZTogU2NyYXRjaC5CbG9ja1R5cGUuSEFULAogICAgICAgICAgICB0ZXh0OiBTY3JhdGNoLnRyYW5zbGF0ZSgid2hlbiBbS0VZX09QVElPTl0ga2V5IFtBQ1RJT05dIiksCiAgICAgICAgICAgIGlzRWRnZUFjdGl2YXRlZDogdHJ1ZSwKICAgICAgICAgICAgYXJndW1lbnRzOiB7CiAgICAgICAgICAgICAgS0VZX09QVElPTjogewogICAgICAgICAgICAgICAgdHlwZTogU2NyYXRjaC5Bcmd1bWVudFR5cGUuU1RSSU5HLAogICAgICAgICAgICAgICAgZGVmYXVsdFZhbHVlOiAic3BhY2UiLAogICAgICAgICAgICAgICAgbWVudTogImtleWJvYXJkQnV0dG9ucyIsCiAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICBBQ1RJT046IHsKICAgICAgICAgICAgICAgIHR5cGU6IFNjcmF0Y2guQXJndW1lbnRUeXBlLlNUUklORywKICAgICAgICAgICAgICAgIG1lbnU6ICJhY3Rpb24iLAogICAgICAgICAgICAgIH0sCiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIGV4dGVuc2lvbnM6IFsiY29sb3Vyc19ldmVudCJdLAogICAgICAgICAgfSwKICAgICAgICAgIHsKICAgICAgICAgICAgb3Bjb2RlOiAid2hpbGVLZXlQcmVzc2VkIiwKICAgICAgICAgICAgYmxvY2tUeXBlOiBTY3JhdGNoLkJsb2NrVHlwZS5IQVQsCiAgICAgICAgICAgIHRleHQ6IFNjcmF0Y2gudHJhbnNsYXRlKCJ3aGlsZSBbS0VZX09QVElPTl0ga2V5IHByZXNzZWQiKSwKICAgICAgICAgICAgaXNFZGdlQWN0aXZhdGVkOiBmYWxzZSwKICAgICAgICAgICAgYXJndW1lbnRzOiB7CiAgICAgICAgICAgICAgS0VZX09QVElPTjogewogICAgICAgICAgICAgICAgdHlwZTogU2NyYXRjaC5Bcmd1bWVudFR5cGUuU1RSSU5HLAogICAgICAgICAgICAgICAgZGVmYXVsdFZhbHVlOiAic3BhY2UiLAogICAgICAgICAgICAgICAgbWVudTogImtleWJvYXJkQnV0dG9ucyIsCiAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgfSwKICAgICAgICAgICAgZXh0ZW5zaW9uczogWyJjb2xvdXJzX2V2ZW50Il0sCiAgICAgICAgICB9LAoKICAgICAgICAgICItLS0iLAoKICAgICAgICAgIHsKICAgICAgICAgICAgb3Bjb2RlOiAiYnJvYWRjYXN0VG9UYXJnZXQiLAogICAgICAgICAgICBibG9ja1R5cGU6IFNjcmF0Y2guQmxvY2tUeXBlLkNPTU1BTkQsCiAgICAgICAgICAgIHRleHQ6IFNjcmF0Y2gudHJhbnNsYXRlKCJicm9hZGNhc3QgW0JST0FEQ0FTVF9PUFRJT05dIHRvIFtUQVJHRVRdIiksCiAgICAgICAgICAgIGFyZ3VtZW50czogewogICAgICAgICAgICAgIEJST0FEQ0FTVF9PUFRJT046IHsKICAgICAgICAgICAgICAgIHR5cGU6IG51bGwsCiAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICBUQVJHRVQ6IHsKICAgICAgICAgICAgICAgIHR5cGU6IFNjcmF0Y2guQXJndW1lbnRUeXBlLlNUUklORywKICAgICAgICAgICAgICAgIG1lbnU6ICJ0YXJnZXRNZW51IiwKICAgICAgICAgICAgICB9LAogICAgICAgICAgICB9LAogICAgICAgICAgICBoaWRlRnJvbVBhbGV0dGU6IHRydWUsCiAgICAgICAgICAgIGV4dGVuc2lvbnM6IFsiY29sb3Vyc19ldmVudCJdLAogICAgICAgICAgfSwKICAgICAgICAgIHsKICAgICAgICAgICAgb3Bjb2RlOiAiYnJvYWRjYXN0VG9UYXJnZXRBbmRXYWl0IiwKICAgICAgICAgICAgYmxvY2tUeXBlOiBTY3JhdGNoLkJsb2NrVHlwZS5DT01NQU5ELAogICAgICAgICAgICB0ZXh0OiBTY3JhdGNoLnRyYW5zbGF0ZSgKICAgICAgICAgICAgICAiYnJvYWRjYXN0IFtCUk9BRENBU1RfT1BUSU9OXSB0byBbVEFSR0VUXSBhbmQgd2FpdCIKICAgICAgICAgICAgKSwKICAgICAgICAgICAgYXJndW1lbnRzOiB7CiAgICAgICAgICAgICAgQlJPQURDQVNUX09QVElPTjogewogICAgICAgICAgICAgICAgdHlwZTogbnVsbCwKICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgIFRBUkdFVDogewogICAgICAgICAgICAgICAgdHlwZTogU2NyYXRjaC5Bcmd1bWVudFR5cGUuU1RSSU5HLAogICAgICAgICAgICAgICAgbWVudTogInRhcmdldE1lbnUiLAogICAgICAgICAgICAgIH0sCiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIGhpZGVGcm9tUGFsZXR0ZTogdHJ1ZSwKICAgICAgICAgICAgZXh0ZW5zaW9uczogWyJjb2xvdXJzX2V2ZW50Il0sCiAgICAgICAgICB9LAoKICAgICAgICAgICItLS0iLAoKICAgICAgICAgIHsKICAgICAgICAgICAgb3Bjb2RlOiAiYnJvYWRjYXN0RGF0YSIsCiAgICAgICAgICAgIGJsb2NrVHlwZTogU2NyYXRjaC5CbG9ja1R5cGUuQ09NTUFORCwKICAgICAgICAgICAgdGV4dDogU2NyYXRjaC50cmFuc2xhdGUoCiAgICAgICAgICAgICAgImJyb2FkY2FzdCBbQlJPQURDQVNUX09QVElPTl0gd2l0aCBkYXRhIFtEQVRBXSIKICAgICAgICAgICAgKSwKICAgICAgICAgICAgYXJndW1lbnRzOiB7CiAgICAgICAgICAgICAgQlJPQURDQVNUX09QVElPTjogewogICAgICAgICAgICAgICAgdHlwZTogbnVsbCwKICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgIERBVEE6IHsKICAgICAgICAgICAgICAgIHR5cGU6IFNjcmF0Y2guQXJndW1lbnRUeXBlLlNUUklORywKICAgICAgICAgICAgICB9LAogICAgICAgICAgICB9LAogICAgICAgICAgICBoaWRlRnJvbVBhbGV0dGU6IHRydWUsCiAgICAgICAgICAgIGV4dGVuc2lvbnM6IFsiY29sb3Vyc19ldmVudCJdLAogICAgICAgICAgfSwKICAgICAgICAgIHsKICAgICAgICAgICAgb3Bjb2RlOiAiYnJvYWRjYXN0RGF0YUFuZFdhaXQiLAogICAgICAgICAgICBibG9ja1R5cGU6IFNjcmF0Y2guQmxvY2tUeXBlLkNPTU1BTkQsCiAgICAgICAgICAgIHRleHQ6IFNjcmF0Y2gudHJhbnNsYXRlKAogICAgICAgICAgICAgICJicm9hZGNhc3QgW0JST0FEQ0FTVF9PUFRJT05dIHdpdGggZGF0YSBbREFUQV0gYW5kIHdhaXQiCiAgICAgICAgICAgICksCiAgICAgICAgICAgIGFyZ3VtZW50czogewogICAgICAgICAgICAgIEJST0FEQ0FTVF9PUFRJT046IHsKICAgICAgICAgICAgICAgIHR5cGU6IG51bGwsCiAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICBEQVRBOiB7CiAgICAgICAgICAgICAgICB0eXBlOiBTY3JhdGNoLkFyZ3VtZW50VHlwZS5TVFJJTkcsCiAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgfSwKICAgICAgICAgICAgaGlkZUZyb21QYWxldHRlOiB0cnVlLAogICAgICAgICAgICBleHRlbnNpb25zOiBbImNvbG91cnNfZXZlbnQiXSwKICAgICAgICAgIH0sCiAgICAgICAgICB7CiAgICAgICAgICAgIGJsb2NrVHlwZTogU2NyYXRjaC5CbG9ja1R5cGUuWE1MLAogICAgICAgICAgICB4bWw6ICc8YmxvY2sgdHlwZT0ibG1zTW9yZUV2ZW50c19icm9hZGNhc3RUb1RhcmdldCI+PHZhbHVlIG5hbWU9IkJST0FEQ0FTVF9PUFRJT04iPjxzaGFkb3cgdHlwZT0iZXZlbnRfYnJvYWRjYXN0X21lbnUiPjwvc2hhZG93PjwvdmFsdWU+PHZhbHVlIG5hbWU9IlRBUkdFVCI+PHNoYWRvdyB0eXBlPSJsbXNNb3JlRXZlbnRzX21lbnVfdGFyZ2V0TWVudSI+PC9zaGFkb3c+PC92YWx1ZT48L2Jsb2NrPjxibG9jayB0eXBlPSJsbXNNb3JlRXZlbnRzX2Jyb2FkY2FzdFRvVGFyZ2V0QW5kV2FpdCI+PHZhbHVlIG5hbWU9IkJST0FEQ0FTVF9PUFRJT04iPjxzaGFkb3cgdHlwZT0iZXZlbnRfYnJvYWRjYXN0X21lbnUiPjwvc2hhZG93PjwvdmFsdWU+PHZhbHVlIG5hbWU9IlRBUkdFVCI+PHNoYWRvdyB0eXBlPSJsbXNNb3JlRXZlbnRzX21lbnVfdGFyZ2V0TWVudSI+PC9zaGFkb3c+PC92YWx1ZT48L2Jsb2NrPjxzZXAgZ2FwPSIzNiIvPjxibG9jayB0eXBlPSJsbXNNb3JlRXZlbnRzX2Jyb2FkY2FzdERhdGEiPjx2YWx1ZSBuYW1lPSJCUk9BRENBU1RfT1BUSU9OIj48c2hhZG93IHR5cGU9ImV2ZW50X2Jyb2FkY2FzdF9tZW51Ij48L3NoYWRvdz48L3ZhbHVlPjx2YWx1ZSBuYW1lPSJEQVRBIj48c2hhZG93IHR5cGU9InRleHQiPjwvc2hhZG93PjwvdmFsdWU+PC9ibG9jaz48YmxvY2sgdHlwZT0ibG1zTW9yZUV2ZW50c19icm9hZGNhc3REYXRhQW5kV2FpdCI+PHZhbHVlIG5hbWU9IkJST0FEQ0FTVF9PUFRJT04iPjxzaGFkb3cgdHlwZT0iZXZlbnRfYnJvYWRjYXN0X21lbnUiPjwvc2hhZG93PjwvdmFsdWU+PHZhbHVlIG5hbWU9IkRBVEEiPjxzaGFkb3cgdHlwZT0idGV4dCI+PC9zaGFkb3c+PC92YWx1ZT48L2Jsb2NrPicsCiAgICAgICAgICB9LAogICAgICAgICAgewogICAgICAgICAgICBvcGNvZGU6ICJyZWNlaXZlZERhdGEiLAogICAgICAgICAgICBibG9ja1R5cGU6IFNjcmF0Y2guQmxvY2tUeXBlLlJFUE9SVEVSLAogICAgICAgICAgICB0ZXh0OiBTY3JhdGNoLnRyYW5zbGF0ZSgicmVjZWl2ZWQgZGF0YSIpLAogICAgICAgICAgICBkaXNhYmxlTW9uaXRvcjogdHJ1ZSwKICAgICAgICAgICAgYWxsb3dEcm9wQW55d2hlcmU6IHRydWUsCiAgICAgICAgICAgIGV4dGVuc2lvbnM6IFsiY29sb3Vyc19ldmVudCJdLAogICAgICAgICAgfSwKCiAgICAgICAgICAiLS0tIiwKCiAgICAgICAgICB7CiAgICAgICAgICAgIG9wY29kZTogImJyb2FkY2FzdERhdGFUb1RhcmdldCIsCiAgICAgICAgICAgIGJsb2NrVHlwZTogU2NyYXRjaC5CbG9ja1R5cGUuQ09NTUFORCwKICAgICAgICAgICAgdGV4dDogU2NyYXRjaC50cmFuc2xhdGUoCiAgICAgICAgICAgICAgImJyb2FkY2FzdCBbQlJPQURDQVNUX09QVElPTl0gdG8gW1RBUkdFVF0gd2l0aCBkYXRhIFtEQVRBXSIKICAgICAgICAgICAgKSwKICAgICAgICAgICAgZnVuYzogImJyb2FkY2FzdFRvVGFyZ2V0IiwKICAgICAgICAgICAgYXJndW1lbnRzOiB7CiAgICAgICAgICAgICAgQlJPQURDQVNUX09QVElPTjogewogICAgICAgICAgICAgICAgdHlwZTogbnVsbCwKICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgIFRBUkdFVDogewogICAgICAgICAgICAgICAgdHlwZTogU2NyYXRjaC5Bcmd1bWVudFR5cGUuU1RSSU5HLAogICAgICAgICAgICAgICAgbWVudTogInRhcmdldE1lbnUiLAogICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgREFUQTogewogICAgICAgICAgICAgICAgdHlwZTogU2NyYXRjaC5Bcmd1bWVudFR5cGUuU1RSSU5HLAogICAgICAgICAgICAgIH0sCiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIGhpZGVGcm9tUGFsZXR0ZTogdHJ1ZSwKICAgICAgICAgICAgZXh0ZW5zaW9uczogWyJjb2xvdXJzX2V2ZW50Il0sCiAgICAgICAgICB9LAogICAgICAgICAgewogICAgICAgICAgICBvcGNvZGU6ICJicm9hZGNhc3REYXRhVG9UYXJnZXRBbmRXYWl0IiwKICAgICAgICAgICAgYmxvY2tUeXBlOiBTY3JhdGNoLkJsb2NrVHlwZS5DT01NQU5ELAogICAgICAgICAgICB0ZXh0OiBTY3JhdGNoLnRyYW5zbGF0ZSgKICAgICAgICAgICAgICAiYnJvYWRjYXN0IFtCUk9BRENBU1RfT1BUSU9OXSB0byBbVEFSR0VUXSB3aXRoIGRhdGEgW0RBVEFdIGFuZCB3YWl0IgogICAgICAgICAgICApLAogICAgICAgICAgICBmdW5jOiAiYnJvYWRjYXN0VG9UYXJnZXRBbmRXYWl0IiwKICAgICAgICAgICAgYXJndW1lbnRzOiB7CiAgICAgICAgICAgICAgQlJPQURDQVNUX09QVElPTjogewogICAgICAgICAgICAgICAgdHlwZTogbnVsbCwKICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgIFRBUkdFVDogewogICAgICAgICAgICAgICAgdHlwZTogU2NyYXRjaC5Bcmd1bWVudFR5cGUuU1RSSU5HLAogICAgICAgICAgICAgICAgbWVudTogInRhcmdldE1lbnUiLAogICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgREFUQTogewogICAgICAgICAgICAgICAgdHlwZTogU2NyYXRjaC5Bcmd1bWVudFR5cGUuU1RSSU5HLAogICAgICAgICAgICAgIH0sCiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIGhpZGVGcm9tUGFsZXR0ZTogdHJ1ZSwKICAgICAgICAgICAgZXh0ZW5zaW9uczogWyJjb2xvdXJzX2V2ZW50Il0sCiAgICAgICAgICB9LAogICAgICAgICAgewogICAgICAgICAgICBibG9ja1R5cGU6IFNjcmF0Y2guQmxvY2tUeXBlLlhNTCwKICAgICAgICAgICAgeG1sOiAnPGJsb2NrIHR5cGU9Imxtc01vcmVFdmVudHNfYnJvYWRjYXN0RGF0YVRvVGFyZ2V0Ij48dmFsdWUgbmFtZT0iQlJPQURDQVNUX09QVElPTiI+PHNoYWRvdyB0eXBlPSJldmVudF9icm9hZGNhc3RfbWVudSI+PC9zaGFkb3c+PC92YWx1ZT48dmFsdWUgbmFtZT0iVEFSR0VUIj48c2hhZG93IHR5cGU9Imxtc01vcmVFdmVudHNfbWVudV90YXJnZXRNZW51Ij48L3NoYWRvdz48L3ZhbHVlPjx2YWx1ZSBuYW1lPSJEQVRBIj48c2hhZG93IHR5cGU9InRleHQiPjwvc2hhZG93PjwvdmFsdWU+PC9ibG9jaz48YmxvY2sgdHlwZT0ibG1zTW9yZUV2ZW50c19icm9hZGNhc3REYXRhVG9UYXJnZXRBbmRXYWl0Ij48dmFsdWUgbmFtZT0iQlJPQURDQVNUX09QVElPTiI+PHNoYWRvdyB0eXBlPSJldmVudF9icm9hZGNhc3RfbWVudSI+PC9zaGFkb3c+PC92YWx1ZT48dmFsdWUgbmFtZT0iVEFSR0VUIj48c2hhZG93IHR5cGU9Imxtc01vcmVFdmVudHNfbWVudV90YXJnZXRNZW51Ij48L3NoYWRvdz48L3ZhbHVlPjx2YWx1ZSBuYW1lPSJEQVRBIj48c2hhZG93IHR5cGU9InRleHQiPjwvc2hhZG93PjwvdmFsdWU+PC9ibG9jaz4nLAogICAgICAgICAgfSwKICAgICAgICAgICItLS0iLAogICAgICAgICAgewogICAgICAgICAgICBibG9ja1R5cGU6IFNjcmF0Y2guQmxvY2tUeXBlLkVWRU5ULAogICAgICAgICAgICBvcGNvZGU6ICJiZWZvcmVTYXZlIiwKICAgICAgICAgICAgdGV4dDogU2NyYXRjaC50cmFuc2xhdGUoImJlZm9yZSBwcm9qZWN0IHNhdmVzIiksCiAgICAgICAgICAgIHNob3VsZFJlc3RhcnRFeGlzdGluZ1RocmVhZHM6IHRydWUsCiAgICAgICAgICAgIGlzRWRnZUFjdGl2YXRlZDogZmFsc2UsCiAgICAgICAgICAgIGV4dGVuc2lvbnM6IFsiY29sb3Vyc19ldmVudCJdLAogICAgICAgICAgfSwKICAgICAgICAgIHsKICAgICAgICAgICAgYmxvY2tUeXBlOiBTY3JhdGNoLkJsb2NrVHlwZS5FVkVOVCwKICAgICAgICAgICAgb3Bjb2RlOiAiYWZ0ZXJTYXZlIiwKICAgICAgICAgICAgdGV4dDogU2NyYXRjaC50cmFuc2xhdGUoImFmdGVyIHByb2plY3Qgc2F2ZXMiKSwKICAgICAgICAgICAgc2hvdWxkUmVzdGFydEV4aXN0aW5nVGhyZWFkczogdHJ1ZSwKICAgICAgICAgICAgaXNFZGdlQWN0aXZhdGVkOiBmYWxzZSwKICAgICAgICAgICAgZXh0ZW5zaW9uczogWyJjb2xvdXJzX2V2ZW50Il0sCiAgICAgICAgICB9LAogICAgICAgIF0sCiAgICAgICAgbWVudXM6IHsKICAgICAgICAgIC8vIFRhcmdldHMgaGF2ZSBhY2NlcHRSZXBvcnRlcnM6IHRydWUKICAgICAgICAgIHRhcmdldE1lbnU6IHsKICAgICAgICAgICAgYWNjZXB0UmVwb3J0ZXJzOiB0cnVlLAogICAgICAgICAgICBpdGVtczogIl9nZXRUYXJnZXRzIiwKICAgICAgICAgIH0sCiAgICAgICAgICBrZXlib2FyZEJ1dHRvbnM6IHsKICAgICAgICAgICAgYWNjZXB0UmVwb3J0ZXJzOiB0cnVlLAogICAgICAgICAgICBpdGVtczogdmFsaWRLZXlib2FyZElucHV0cywKICAgICAgICAgIH0sCiAgICAgICAgICAvLyBBdHRyaWJ1dGVzIGhhdmUgYWNjZXB0UmVwb3J0ZXJzOiBmYWxzZQogICAgICAgICAgYWN0aW9uOiB7CiAgICAgICAgICAgIGFjY2VwdFJlcG9ydGVyczogZmFsc2UsCiAgICAgICAgICAgIGl0ZW1zOiBbCiAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgdGV4dDogU2NyYXRjaC50cmFuc2xhdGUoImhpdCIpLAogICAgICAgICAgICAgICAgdmFsdWU6ICJoaXQiLAogICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgdGV4dDogU2NyYXRjaC50cmFuc2xhdGUoInJlbGVhc2VkIiksCiAgICAgICAgICAgICAgICB2YWx1ZTogInJlbGVhc2VkIiwKICAgICAgICAgICAgICB9LAogICAgICAgICAgICBdLAogICAgICAgICAgfSwKICAgICAgICAgIGJvb2xlYW46IHsKICAgICAgICAgICAgYWNjZXB0UmVwb3J0ZXJzOiBmYWxzZSwKICAgICAgICAgICAgaXRlbXM6IFsKICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICB0ZXh0OiBTY3JhdGNoLnRyYW5zbGF0ZSgidHJ1ZSIpLAogICAgICAgICAgICAgICAgdmFsdWU6ICJ0cnVlIiwKICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIHRleHQ6IFNjcmF0Y2gudHJhbnNsYXRlKCJmYWxzZSIpLAogICAgICAgICAgICAgICAgdmFsdWU6ICJmYWxzZSIsCiAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgXSwKICAgICAgICAgIH0sCiAgICAgICAgICAvLyBUaGlzIG1lbnUgaXMgdW51c2VkLCBob3dldmVyIHdlIGNhbid0IHJlbW92ZSBpdCBhcyB0aGF0IGNvdWxkIGJyZWFrIHByb2plY3RzCiAgICAgICAgICAvLyB0aGF0IHVzZSB0aGUgbWVudSB0aHJvdWdoIHRoZSBBbGwgTWVudXMgZXh0ZW5zaW9uLgogICAgICAgICAgc3RhdGU6IHsKICAgICAgICAgICAgYWNjZXB0UmVwb3J0ZXJzOiBmYWxzZSwKICAgICAgICAgICAgaXRlbXM6IFsKICAgICAgICAgICAgICAvLyBVbnVzZWQsIHNvIGRvbid0IGJvdGhlciB0cmFuc2xhdGluZwogICAgICAgICAgICAgICJlbmFibGVkIiwKICAgICAgICAgICAgICAiZGlzYWJsZWQiLAogICAgICAgICAgICBdLAogICAgICAgICAgfSwKICAgICAgICB9LAogICAgICB9OwogICAgfQoKICAgIHdoZW5UcnVlRmFsc2UoYXJncykgewogICAgICByZXR1cm4gYXJncy5TVEFURSA9PT0gInRydWUiID8gYXJncy5DT05ESVRJT04gOiAhYXJncy5DT05ESVRJT047CiAgICB9CgogICAgd2hpbGVUcnVlRmFsc2UoYXJncykgewogICAgICByZXR1cm4gYXJncy5TVEFURSA9PT0gInRydWUiID8gYXJncy5DT05ESVRJT04gOiAhYXJncy5DT05ESVRJT047CiAgICB9CgogICAgd2hlblZhbHVlQ2hhbmdlZChhcmdzLCB1dGlsKSB7CiAgICAgIGNvbnN0IGJsb2NrSWQgPSB1dGlsLnRocmVhZC5wZWVrU3RhY2soKTsKICAgICAgaWYgKCFsYXN0VmFsdWVzW2Jsb2NrSWRdKQogICAgICAgIGxhc3RWYWx1ZXNbYmxvY2tJZF0gPSBTY3JhdGNoLkNhc3QudG9TdHJpbmcoYXJncy5JTlBVVCk7CiAgICAgIGlmIChsYXN0VmFsdWVzW2Jsb2NrSWRdICE9PSBTY3JhdGNoLkNhc3QudG9TdHJpbmcoYXJncy5JTlBVVCkpIHsKICAgICAgICBsYXN0VmFsdWVzW2Jsb2NrSWRdID0gU2NyYXRjaC5DYXN0LnRvU3RyaW5nKGFyZ3MuSU5QVVQpOwogICAgICAgIHJldHVybiB0cnVlOwogICAgICB9CiAgICAgIHJldHVybiBmYWxzZTsKICAgIH0KCiAgICBldmVyeUR1cmF0aW9uKGFyZ3MsIHV0aWwpIHsKICAgICAgY29uc3QgZHVyYXRpb24gPSBNYXRoLm1heCgKICAgICAgICBNYXRoLnJvdW5kKFNjcmF0Y2guQ2FzdC50b051bWJlcihhcmdzLkRVUkFUSU9OKSksCiAgICAgICAgMAogICAgICApOwogICAgICByZXR1cm4gISEocnVuVGltZXIgJSBkdXJhdGlvbiA9PT0gMCk7CiAgICB9CgogICAgd2hlbktleUFjdGlvbihhcmdzLCB1dGlsKSB7CiAgICAgIGNvbnN0IGtleSA9IFNjcmF0Y2guQ2FzdC50b1N0cmluZyhhcmdzLktFWV9PUFRJT04pLnRvTG93ZXJDYXNlKCk7CiAgICAgIGNvbnN0IHByZXNzZWQgPSB1dGlsLmlvUXVlcnkoImtleWJvYXJkIiwgImdldEtleUlzRG93biIsIFtrZXldKTsKICAgICAgcmV0dXJuIGFyZ3MuQUNUSU9OID09PSAicmVsZWFzZWQiID8gIXByZXNzZWQgOiBwcmVzc2VkOwogICAgfQoKICAgIHdoaWxlS2V5UHJlc3NlZChhcmdzLCB1dGlsKSB7CiAgICAgIGNvbnN0IGtleSA9IFNjcmF0Y2guQ2FzdC50b1N0cmluZyhhcmdzLktFWV9PUFRJT04pLnRvTG93ZXJDYXNlKCk7CiAgICAgIHJldHVybiB1dGlsLmlvUXVlcnkoImtleWJvYXJkIiwgImdldEtleUlzRG93biIsIFtrZXldKTsKICAgIH0KCiAgICBicm9hZGNhc3RUb1RhcmdldChhcmdzLCB1dGlsKSB7CiAgICAgIGNvbnN0IGJyb2FkY2FzdE9wdGlvbiA9IFNjcmF0Y2guQ2FzdC50b1N0cmluZyhhcmdzLkJST0FEQ0FTVF9PUFRJT04pOwogICAgICBpZiAoIWJyb2FkY2FzdE9wdGlvbikgcmV0dXJuOwoKICAgICAgY29uc3QgZGF0YSA9IFNjcmF0Y2guQ2FzdC50b1N0cmluZyhhcmdzLkRBVEEpOwogICAgICBjb25zb2xlLmxvZyhkYXRhKTsKCiAgICAgIGNvbnN0IGNsb25lVGFyZ2V0cyA9IHRoaXMuX2dldFRhcmdldEZyb21NZW51KGFyZ3MuVEFSR0VUKS5zcHJpdGUuY2xvbmVzOwogICAgICBsZXQgc3RhcnRlZFRocmVhZHMgPSBbXTsKCiAgICAgIGZvciAoY29uc3QgY2xvbmUgb2YgY2xvbmVUYXJnZXRzKSB7CiAgICAgICAgc3RhcnRlZFRocmVhZHMgPSBbCiAgICAgICAgICAuLi5zdGFydGVkVGhyZWFkcywKICAgICAgICAgIC4uLnV0aWwuc3RhcnRIYXRzKAogICAgICAgICAgICAiZXZlbnRfd2hlbmJyb2FkY2FzdHJlY2VpdmVkIiwKICAgICAgICAgICAgewogICAgICAgICAgICAgIEJST0FEQ0FTVF9PUFRJT046IGJyb2FkY2FzdE9wdGlvbiwKICAgICAgICAgICAgfSwKICAgICAgICAgICAgY2xvbmUKICAgICAgICAgICksCiAgICAgICAgXTsKICAgICAgICBpZiAoZGF0YSkgewogICAgICAgICAgc3RhcnRlZFRocmVhZHMuZm9yRWFjaCgodGhyZWFkKSA9PiAodGhyZWFkLnJlY2VpdmVkRGF0YSA9IGFyZ3MuREFUQSkpOwogICAgICAgIH0KICAgICAgfQogICAgfQoKICAgIGJyb2FkY2FzdFRvVGFyZ2V0QW5kV2FpdChhcmdzLCB1dGlsKSB7CiAgICAgIGlmICghdXRpbC5zdGFja0ZyYW1lLmJyb2FkY2FzdFZhcikgewogICAgICAgIHV0aWwuc3RhY2tGcmFtZS5icm9hZGNhc3RWYXIgPSBTY3JhdGNoLkNhc3QudG9TdHJpbmcoCiAgICAgICAgICBhcmdzLkJST0FEQ0FTVF9PUFRJT04KICAgICAgICApOwogICAgICB9CgogICAgICBjb25zdCBzcHJpdGVUYXJnZXQgPSB0aGlzLl9nZXRUYXJnZXRGcm9tTWVudShhcmdzLlRBUkdFVCk7CiAgICAgIGlmICghc3ByaXRlVGFyZ2V0KSByZXR1cm47CiAgICAgIGNvbnN0IGNsb25lVGFyZ2V0cyA9IHNwcml0ZVRhcmdldC5zcHJpdGUuY2xvbmVzOwoKICAgICAgY29uc3QgZGF0YSA9IFNjcmF0Y2guQ2FzdC50b1N0cmluZyhhcmdzLkRBVEEpOwoKICAgICAgaWYgKHV0aWwuc3RhY2tGcmFtZS5icm9hZGNhc3RWYXIpIHsKICAgICAgICBjb25zdCBicm9hZGNhc3RPcHRpb24gPSB1dGlsLnN0YWNrRnJhbWUuYnJvYWRjYXN0VmFyOwogICAgICAgIGlmICghdXRpbC5zdGFja0ZyYW1lLnN0YXJ0ZWRUaHJlYWRzKSB7CiAgICAgICAgICB1dGlsLnN0YWNrRnJhbWUuc3RhcnRlZFRocmVhZHMgPSBbXTsKICAgICAgICAgIGZvciAoY29uc3QgY2xvbmUgb2YgY2xvbmVUYXJnZXRzKSB7CiAgICAgICAgICAgIHV0aWwuc3RhY2tGcmFtZS5zdGFydGVkVGhyZWFkcyA9IFsKICAgICAgICAgICAgICAuLi51dGlsLnN0YWNrRnJhbWUuc3RhcnRlZFRocmVhZHMsCiAgICAgICAgICAgICAgLi4udXRpbC5zdGFydEhhdHMoCiAgICAgICAgICAgICAgICAiZXZlbnRfd2hlbmJyb2FkY2FzdHJlY2VpdmVkIiwKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgQlJPQURDQVNUX09QVElPTjogYnJvYWRjYXN0T3B0aW9uLAogICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgIGNsb25lCiAgICAgICAgICAgICAgKSwKICAgICAgICAgICAgXTsKICAgICAgICAgICAgaWYgKGRhdGEpIHsKICAgICAgICAgICAgICB1dGlsLnN0YWNrRnJhbWUuc3RhcnRlZFRocmVhZHMuZm9yRWFjaCgKICAgICAgICAgICAgICAgICh0aHJlYWQpID0+ICh0aHJlYWQucmVjZWl2ZWREYXRhID0gYXJncy5EQVRBKQogICAgICAgICAgICAgICk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICAgIGlmICh1dGlsLnN0YWNrRnJhbWUuc3RhcnRlZFRocmVhZHMubGVuZ3RoID09PSAwKSB7CiAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIGNvbnN0IHdhaXRpbmcgPSB1dGlsLnN0YWNrRnJhbWUuc3RhcnRlZFRocmVhZHMuc29tZSgKICAgICAgICAgICh0aHJlYWQpID0+IHJ1bnRpbWUudGhyZWFkcy5pbmRleE9mKHRocmVhZCkgIT09IC0xCiAgICAgICAgKTsKICAgICAgICBpZiAod2FpdGluZykgewogICAgICAgICAgaWYgKAogICAgICAgICAgICB1dGlsLnN0YWNrRnJhbWUuc3RhcnRlZFRocmVhZHMuZXZlcnkoKHRocmVhZCkgPT4KICAgICAgICAgICAgICBydW50aW1lLmlzV2FpdGluZ1RocmVhZCh0aHJlYWQpCiAgICAgICAgICAgICkKICAgICAgICAgICkgewogICAgICAgICAgICB1dGlsLnlpZWxkVGljaygpOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgdXRpbC55aWVsZCgpOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQogICAgfQoKICAgIGJyb2FkY2FzdERhdGEoYXJncywgdXRpbCkgewogICAgICBjb25zdCBicm9hZGNhc3QgPSBTY3JhdGNoLkNhc3QudG9TdHJpbmcoYXJncy5CUk9BRENBU1RfT1BUSU9OKTsKICAgICAgaWYgKCFicm9hZGNhc3QpIHJldHVybjsKCiAgICAgIGNvbnN0IGRhdGEgPSBTY3JhdGNoLkNhc3QudG9TdHJpbmcoYXJncy5EQVRBKTsKCiAgICAgIGxldCB0aHJlYWRzID0gdXRpbC5zdGFydEhhdHMoImV2ZW50X3doZW5icm9hZGNhc3RyZWNlaXZlZCIsIHsKICAgICAgICBCUk9BRENBU1RfT1BUSU9OOiBicm9hZGNhc3QsCiAgICAgIH0pOwogICAgICB0aHJlYWRzLmZvckVhY2goKHRocmVhZCkgPT4gKHRocmVhZC5yZWNlaXZlZERhdGEgPSBkYXRhKSk7CiAgICB9CgogICAgYnJvYWRjYXN0RGF0YUFuZFdhaXQoYXJncywgdXRpbCkgewogICAgICBjb25zdCBkYXRhID0gU2NyYXRjaC5DYXN0LnRvU3RyaW5nKGFyZ3MuREFUQSk7CgogICAgICBpZiAoIXV0aWwuc3RhY2tGcmFtZS5icm9hZGNhc3RWYXIpIHsKICAgICAgICB1dGlsLnN0YWNrRnJhbWUuYnJvYWRjYXN0VmFyID0gU2NyYXRjaC5DYXN0LnRvU3RyaW5nKAogICAgICAgICAgYXJncy5CUk9BRENBU1RfT1BUSU9OCiAgICAgICAgKTsKICAgICAgfQoKICAgICAgaWYgKHV0aWwuc3RhY2tGcmFtZS5icm9hZGNhc3RWYXIpIHsKICAgICAgICBjb25zdCBicm9hZGNhc3RPcHRpb24gPSB1dGlsLnN0YWNrRnJhbWUuYnJvYWRjYXN0VmFyOwogICAgICAgIGlmICghdXRpbC5zdGFja0ZyYW1lLnN0YXJ0ZWRUaHJlYWRzKSB7CiAgICAgICAgICB1dGlsLnN0YWNrRnJhbWUuc3RhcnRlZFRocmVhZHMgPSB1dGlsLnN0YXJ0SGF0cygKICAgICAgICAgICAgImV2ZW50X3doZW5icm9hZGNhc3RyZWNlaXZlZCIsCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICBCUk9BRENBU1RfT1BUSU9OOiBicm9hZGNhc3RPcHRpb24sCiAgICAgICAgICAgIH0KICAgICAgICAgICk7CiAgICAgICAgICBpZiAodXRpbC5zdGFja0ZyYW1lLnN0YXJ0ZWRUaHJlYWRzLmxlbmd0aCA9PT0gMCkgewogICAgICAgICAgICByZXR1cm47CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICB1dGlsLnN0YWNrRnJhbWUuc3RhcnRlZFRocmVhZHMuZm9yRWFjaCgKICAgICAgICAgICAgICAodGhyZWFkKSA9PiAodGhyZWFkLnJlY2VpdmVkRGF0YSA9IGRhdGEpCiAgICAgICAgICAgICk7CiAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICBjb25zdCB3YWl0aW5nID0gdXRpbC5zdGFja0ZyYW1lLnN0YXJ0ZWRUaHJlYWRzLnNvbWUoCiAgICAgICAgICAodGhyZWFkKSA9PiBydW50aW1lLnRocmVhZHMuaW5kZXhPZih0aHJlYWQpICE9PSAtMQogICAgICAgICk7CiAgICAgICAgaWYgKHdhaXRpbmcpIHsKICAgICAgICAgIGlmICgKICAgICAgICAgICAgdXRpbC5zdGFja0ZyYW1lLnN0YXJ0ZWRUaHJlYWRzLmV2ZXJ5KCh0aHJlYWQpID0+CiAgICAgICAgICAgICAgcnVudGltZS5pc1dhaXRpbmdUaHJlYWQodGhyZWFkKQogICAgICAgICAgICApCiAgICAgICAgICApIHsKICAgICAgICAgICAgdXRpbC55aWVsZFRpY2soKTsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHV0aWwueWllbGQoKTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KICAgIH0KCiAgICByZWNlaXZlZERhdGEoYXJncywgdXRpbCkgewogICAgICBjb25zdCByZWNlaXZlZCA9IHV0aWwudGhyZWFkLnJlY2VpdmVkRGF0YTsKICAgICAgcmV0dXJuIHJlY2VpdmVkID8gcmVjZWl2ZWQgOiAiIjsKICAgIH0KCiAgICBfZ2V0VGFyZ2V0RnJvbU1lbnUodGFyZ2V0TmFtZSkgewogICAgICBsZXQgdGFyZ2V0ID0gU2NyYXRjaC52bS5ydW50aW1lLmdldFNwcml0ZVRhcmdldEJ5TmFtZSh0YXJnZXROYW1lKTsKICAgICAgaWYgKHRhcmdldE5hbWUgPT09ICJfc3RhZ2VfIikgdGFyZ2V0ID0gcnVudGltZS5nZXRUYXJnZXRGb3JTdGFnZSgpOwogICAgICByZXR1cm4gdGFyZ2V0OwogICAgfQoKICAgIF9nZXRUYXJnZXRzKCkgewogICAgICBjb25zdCBzcHJpdGVOYW1lcyA9IFt7IHRleHQ6ICJTdGFnZSIsIHZhbHVlOiAiX3N0YWdlXyIgfV07CiAgICAgIGNvbnN0IHRhcmdldHMgPSBTY3JhdGNoLnZtLnJ1bnRpbWUudGFyZ2V0czsKICAgICAgZm9yIChsZXQgaW5kZXggPSAxOyBpbmRleCA8IHRhcmdldHMubGVuZ3RoOyBpbmRleCsrKSB7CiAgICAgICAgY29uc3QgdGFyZ2V0ID0gdGFyZ2V0c1tpbmRleF07CiAgICAgICAgaWYgKHRhcmdldC5pc09yaWdpbmFsKSB7CiAgICAgICAgICBjb25zdCB0YXJnZXROYW1lID0gdGFyZ2V0LmdldE5hbWUoKTsKICAgICAgICAgIHNwcml0ZU5hbWVzLnB1c2goewogICAgICAgICAgICB0ZXh0OiB0YXJnZXROYW1lLAogICAgICAgICAgICB2YWx1ZTogdGFyZ2V0TmFtZSwKICAgICAgICAgIH0pOwogICAgICAgIH0KICAgICAgfQogICAgICBpZiAoc3ByaXRlTmFtZXMubGVuZ3RoID4gMCkgewogICAgICAgIHJldHVybiBzcHJpdGVOYW1lczsKICAgICAgfSBlbHNlIHsKICAgICAgICByZXR1cm4gW3sgdGV4dDogIiIsIHZhbHVlOiAwIH1dOyAvL3RoaXMgc2hvdWxkIG5ldmVyIGhhcHBlbiBidXQgaXQncyBhIGZhaWxzYWZlCiAgICAgIH0KICAgIH0KICB9CgogIFNjcmF0Y2guZXh0ZW5zaW9ucy5yZWdpc3RlcihuZXcgTW9yZUV2ZW50cygpKTsKfSkoU2NyYXRjaCk7","data:text/javascript;base64,LyohDQogKiBEaXNjb3JkIEFQSSAtIEJ5IEx1a2VNYW5pYVN0dWRpb3MgLSBWZXJzaW9uIDEuMA0KICovDQoNCihmdW5jdGlvbiAoU2NyYXRjaCkgew0KICAndXNlIHN0cmljdCc7DQoNCiAgY29uc3Qgdm0gPSBTY3JhdGNoLnZtOw0KICBjb25zdCBydW50aW1lID0gdm0ucnVudGltZTsNCg0KICBsZXQgZGlzY29yZEljb24gPSAnZGF0YTppbWFnZS9wbmc7YmFzZTY0LGlWQk9SdzBLR2dvQUFBQU5TVWhFVWdBQUFNQUFBQURBQ0FZQUFBQlMzR3dIQUFBQUFYTlNSMElBcnM0YzZRQUFDcGRKUkVGVWVGN3RuZUY1N0VRTVJaTUdxSThHb0FIcW9BRm9nUHBvQUw3TncyR3pzVDBhamFTNWt1NzdHOXM3dWpwbk5ONzNDTzl2L0dPZXdNKy8vUDJQK1VQZjN0Nysrdk9uZDQvbmRuNG1BMVYyM3d0eTVYSW9oekk0Q2lBTURnMzQwYkk1TFVZSi9mZzVCYmpJS1J2d28zWlRpUE9FS01CL3VWUURua0tNRXVBRStFaWdHL2l2V0hTZkRDMG5RSGZvci9iR2pqSzBFWURReTQ0RXgxVmRaQ2d2QU1HZkE3L2JFYW1zQUFSL0Rmd3VJcFFUZ09EYmdsOWRoRElDRUh4ZjhLdUtrRjRBZ2g4TGZqVVJVZ3RBK1BmQ1grRWJvNVFDRUh3TThDdE1nMVFDRUh4TThET0xrRVlBd3A4RC9tekhvaFFDRVA1YzhHZVNBRm9BZ3A4VC9FeEhJbGdCQ0g4TitOR25BYVFBaEw4Vy9NZ1NRQWxBOEd1Q2ozd2tnaEdBOFBlQUgyMGFRQWhBK0h2Qmp5VEJkZ0VJZjAvNFVTVFlLZ0RoN3cwL2dnVGJCQ0Q4aFA4NWdWMy9DZVlXQVFnLzRUOUxZSWNFNFFJUWZzSi9sMEMwQktFQ0VIN0NMMGtnVW9Jd0FRaS9wUFc4SnZyRk9FUUF3ayt3TlFsRVRBSjNBUWkvcHZXOEoyb1N1QXBBK0FteVJRS2VrOEJOZ096dy8vSDcxOWI5K3B0RksrT2VrWDM5VWYrQXprV0FiUEMvd25LR2FYWUJLdFRrTVFsYUNpQUJQak13VmV0TElRRHE3cStGNGxtRUxGT2djcTNXRXBoT0FEVDRMVUI0blFUb0VuU28yVklDTXdGUTRQY0FJTk1VNkZLL2xRUWxCUEJ1ZXBZcDBDa0hLQUYyN1A3UnpkWk1BYXMxU285ZFZwK24rYkpXdWtiTnM2L3VzWkJnZVFKRXc3K3p5WmJOcS9xc2FCRldKVmdTSUJKK2dwOUxtVWdSVmlTQUY0RGc1d0oveC92U0ZnRWlkbi9Dbnh2K1kvVVIwMEFyZ1hvQ1VJQWFjRVpVVVU0QXdoK0JUYTNQUUpWZ2VnSVEvbHBnUmxhREtBRUZpQ1NnK1dlbEY0QzdmM09DRGNwSGsyQnFBbEFBQXdLYVB5S3RBSVMvT2JtRzVTTkpJSjRBM2dMd08zOUR3aEk4eWxzQzZkOExpQVR3aHYvUkx3cVFnRnJESlhvTDhGaXFSQUlJQVFpL0lWbUpIdVV0Z1lrQTNQMFRFWlZzcWQ0Q1NLYkFjQUo0QzhEZFB4bTF4c3YxbG1BMEJXNEY4SWFmWjM5am1oSSt6bHVBMFJUWUtnQjMvNFRFT2l6Wlc0SzdLVUFCSEJyS1I4NGxBQ21BOS9HSHUvOGNKTld2M2lYQjVRU2dBTldSdzZxdmxRRGMvYkhnUTFtTnB3Ulg3d0duRTRDN1B3b1N2ZGJoS2NEVnQwSGhBbkQzN3dYMWJMV2VFcHhOZ1c4Q2NQZWZiUm12dDB6QVU0Q3pLUkFxQUhkL1MxVHFQc3RUZ3RjcFFBSHFjcFMyc3BJQ2NQZFB5MlA0d3JjSjRIbitwd0RoSEtYK3dDZ0p2aHlCS0VCcVprb3R2cFFBM1AxTHNSbFdqSmNFenkvQ0lST0FBb1F4VStxRFFnWGc4YWNVTzJXSzhaYmdjd0o0Q2NEZHZ3eUxXd3FoQUZ0aTU0ZWlKSkJhQU83K0tCamxYb2VIQk1lTDhNY1JpTWVmM0lCVVg3MkhBTWUvQzZJQTFla3BVRjlLQVhqOEtVQWVVQWtlRWp5T1FXNFRnQUlBMFZOZ0tSU2dRQk5aZ2o2QlZBSnc5OWMzbW5kZUoyQXRnZHNSaUFJUVk0OEVYQVR3K0FxVUFuaTBuOCswRnVDUjZEc0ZlSHVUQkp0UjZsRmQyV29hMWFQWklzd0Z5QlNxSmxEMCtpclc5QXkycHI0N01Wb0tzQm9pcWdSVjY2SUFtdGwyY2M4cUpNZGowU1NvV3Rkckc2M3FQSjVyT2dIUW9QQU83L0Y4aEpxdG9VQ282V3JQczY2MWpRRFd3YUZNZ3FwMTNRMTl5NW9wZ01IeGF0ZU9hUW5DYXd5N2FwSzB3N0x1RmdKWUJuYlZvR2hnS3RZa2dmOXhqV1h0RkVDYSt1QzZpZ0tndk9ONHZzdVpDUkFOZ0pSYnk5MWk5Sm1SR1VUVkZWblRLRitQcjBNcHdFenFJRk1nQ243VUNXQjVEQ290UUNRb2tiQlVyV3RtTDdMS2dBTE1wTjV3QWtTS1BkTUtDaUJJeXlva3dVZDlYdUo5WnE1WTAweSt4N1ZXT1poTUFPK21hd0t5UENmT2ZMNTNGbGFOUjZwcFppM1dMOElVUUp2K3hYMFV3RGpRbThkWmJBWVV3TGhmRk1BNFVBcWdEOVJpaDVqOWRBb3dtNWorZW92K2NnTG84eis5a3dJWUI4b0pvQS9VWW9lWStYUnYrSzIvQVpIV0ZsV1hkRDJXT1hBQ3pLWitjMzBVS0ZYRm5tMkZSUTRtdnhrdXF2R3pBVVYvRlJxVmcwWGpwVmxHMVNSZGorWFhvQ2EvRndnNUlBcWd3ZXJyUFpYN1N3SFcrZmg4UWpRb1VWTWd1cTdabHF6azBFS0FxQ2tRRGNwSzQ2V1FSZGNrWFpmVk1ZZ0NhQkkvdVdjWEtONFM3S3BycGkwckdiUVJ3SE1LN0laa0JZQTcwSGJYSlpWZ3BmNVdBbmhKc0J1VUZRQ3VJTnRka3hUKzFaNStDdkI0a1BaM2hHWUtheld3MThhZzFHNHBBVXBOVWdtMHRYLzVuK1IxRXNCS0FqUlF0Q0E4ZzRaV2swUUNiZDJ0QlZpUkFCMFNMUkRvZFYzSm9LMjN2UUJIb05JQXN3RlN0YTVYRWFSMXZ0NzNUUUR0TVNnYkdLT3hlZ1RLdWtaSllmeGNJOEFCLzZPQ2ozOExkUHpSdkFoWEF3V2pyVnlGTkFFS0lFMksxNVZNZ0FLVWJDdUxraVpnS29EbVBZQkhJR21yZUoxSEFyTUNQSi8vdjcwRFVBQ1BGdkdabmdsUUFNOTArV3o0QkNnQWZJdTRRTThFekFXWVBRYnhIY0N6dlh6MktJRVpBVjdQLzZmdkFCUmdGRGwvanBTQWl3QXpFbkFDSU9IUWJ5MVNBYzUyLzhzSlFBSDZnWlMxWWdxUXRYTmN0MGtDYmdKSXB3Q1BRQ1o5NUVPVUNVZ0V1RHIrM0I2QktJQ3lJN3d0TkFFS0VCbzNQd3d0QVZjQkpGT0FSeUEwSkhxdFp5VEEzZkZuZUFUS0xNQnJNQlIxVG93cytia0xNSklBRWF5N1VCRFhPNGVtNzlYWnNydGI3MmozRjAyQWJBS01kb1JuZkNqRGp6UXlaeFlpd0VpQ3g4L1JZTXJjVk44OS92K25aODVvdEhiSjdpK2VBQklCRUNXWTNkMVFhN0FVWWdUTzYyZWhiV3pTbnBvTElKVUFGYUxaeGg4Z0lBSXdJMFNsdXFXMVNPR2ZtZ0F6QXFCS0lOMDlyZ0RMSW9NVWxMTTZVV3VjcWNsTmdGa0pxb3FBY2t5WWdXSTBOU3FBLzZoeEJ2N3BDYUFSQUZtQ0F3cExrS3ltQitLYVJoSlovMXlUZ2JzQVdnbVFSZEFFYmQzc0hjK3JzdXNmMmMzQ3I1b0F4NGRwZm9zY3FnUVVZSWQrNTUrcDdZVUcvaTBDb0gyN29nMGNCNW0xbGFCTWdkVStoQXV3Y2hSNmJ0bnVCcXdHdjRiZi9yc3I1SytGZjJrQ1dBbXdjeUowaDc5Szl0c0VzSllnK2gyQkF2eFFJSElLV0dlK0F2L3lCRmg5SWI0N0FIZzN4Ym9SK3c4emF5dkltUGNxL0dZQ2VFd0N6L0ZNK005bDhaREFLMnNMK0ZNSTRDR0NWMVBXOXVEOWQxc0s0SjB4bkFDZVU4RHlXeVB2eHV6SGVHMEZxeEpFNUdzRnYra0U4SHdmT0d1cHBsRVJ6Vm5ERCtOdTVHd3Q0WGNSSUdvU2FLWUNCWkFKSmhVZ09rOXIrTXNJSUpFaHVsa3kxSEN2dXBKZ1o0NXBCTmd4QmU2T1NUdWJob3Y0ZUdXSEJBajVlY0R2TmdHaTN3ZkdyZVFWbVJQd2d0OWRBSlJKa0xuNTNkZnVDWCtJQUpTZ084TDYrcjNoRHhPQUV1Z2g2SHBuQlB5aEFsQ0NyaWpQMXgwRmY3Z0FsR0FlaG01M1JNSy9SUUJLMEExcGViM1I4RzhUZ0JMSW9laHk1UTc0dHdwQUNicWdQYTV6Ri96YkJhQUVZemlxWDdFVGZnZ0JLRUYxeEsvcjJ3MC9qQUNVb0o4RUNQQkRDVUFKK2tpQUFqK2NBQWNDMnQ4NjF3ZWhuSlVpZ1g4aytJNGFKU1ZBN1l4dVhZand3MDRBVGdJZFpLaDNvY0lQTHdCRlFFVmF0aTVrOE9HUFFLOFI4MGdrZ3c3bHFnendwNWtBbkFRb1dNdldrUVgrZEFKUUJCbUF1NjdLQkg2Nkk5QlpVM2tzMm9YNjE4L05DSDRKQVI1RlVJSzlFbVNHUCswUmlOTmdML1NQVDg4T2Zwa0p3RytMWW1Xb0FuNVpBZmlpN0NORU5mRExDMEFSYkVTb0NuNGJBU2lDVG9UcTRMY1Q0QmtEZm5OMExrVVg2SityaC8zWG9McDlhLzZ1N2pKMGhKNENuSGpTVFlUdTRMYytBa25tUkRVaENQeDUxOXNmZ1NReVpQd2Jad0l2Nnl3RmtPWDA3U3EwQ1VIZ2RZMmtBTHJjYnUveWtvT1EyemZyWHoyUHNmR3NJNlFrQUFBQUFFbEZUa1N1UW1DQyc7DQogIGxldCB3ZWJob29rSWNvbiA9ICdkYXRhOmltYWdlL3BuZztiYXNlNjQsaVZCT1J3MEtHZ29BQUFBTlNVaEVVZ0FBQU1BQUFBREFDQVlBQUFCUzNHd0hBQUFBQVhOU1IwSUFyczRjNlFBQURJSkpSRUZVZUY3dG5lMTY1TFlPZzVQN3YrajB5VzZublV6c0VVaUMxQWR4L3E0c2tnQmV5Wjd0YVQ4LzlMOHlCYjYrdnI2UVlwK2ZuNS9JT3EySkt5Q2g0eHIrMmdFTnVyVzB3TEFxTmw0dkFNWWFRU3V5UW45WFhEQkF0Z3dYQ1lDaFJQY0xxa012R0FKbTNUd3FBQnlhcmhMODE5WjFLOWpORkFBR3pWWU52a0F3bVBpeVZBQUEydTBTZklFQW1Da0FiQ0x0R3Y3SGxIb3RldSszYm9BYmZYWVB2bTREN0tBVEFCYzZuUlorM1FiM01BaUFGMjFPRGI4Z3VJWkFBRHpwY25yNEJjRnZDQVRBeDhkSGwrRHJ1MEFBWE42REFnRDdZRHh4VmZzYm9HdjQ5VHIwVjRIV0FIUVB2eUJvRElEQy8vT0ZwdXRmbUxXOEFSVCttNThFRy80ZmNkb0JNQ1A4M3ROMXAxNTMvVUFXQUVuT2VVTi8xMDRWRE95K2srU2xiZHNLZ0lvUVpRZm9oQmxvNlNWc0pBQUlJdjc1T2EzNC9Ua1RoT3BaU0JhNHRta0R3SW1CT1hFbVY0b0REd21BaUhqRnAzN2w5MEdYVzZBRkFCa241V29CNlRCajRLeTZmZlI0QURvRm85T3NMQmdFZ0ZGSnhzbC9GOVRNdlkxai9yZWMwWk8zZHNWekFzQ29zaWNRM3BPNXN0YWRESjRlakpKT1hYNDBBTjdnc2NMQXFtOE5JYXR1aDM5WVRnQ0E1ODl1SVdSQ1lKMGRsSFNKWlFJQXNNRWFBR2I0bnR1YjFZZTFMaURwTWt1T0JZQVpRalFBekpydkVqS2pIN1RtTXNrR0d4RUFBNkVzeHE4R3dQZG9ySjRzT29EWlcyS1pBQ0FCd0FvYW1nbzBrS3krMEhwby82dXNPeElBbHVuZkppSEdNK3RaZ2xIZEcxTFAwdjhLYXdYQUd4ZFF3MWNHUUs5Qjd6RVRBRUVBWm9YZjhoczlxMGYwUUZqaFpFZDdFQUFDQU0wSzlEb0liN2JJUWdGd1l3UnkyckZPMW1nV3FucEY2a1JucVg1ZUFBZ0FPSE1DQUpacTdrTEd5WXlZemFqRFVLcXFWNlFPWTU3S1BYUUQ2QWFBOHlZQVlLbm1MV1NkeW9qWnJGcFJ0U3A3UldwRjU2bDgvcmdiZ0JWS3hHaFdyYWpobGIwaXRhTHpWRDR2QUpxOEFsV0dhcWRhQWtBQTdKUlhlcS9IQWZDdEVPUFZCTG5xR1hVWWppSzlNdXFjdUljQTBBMXdZcTdobVFTQUFJRERjdUpDQWZER1ZlVFZZdlpyRU5MamljRmx6U1FBQkFBclMxdnVJd0EyQmtDbmY1dzVBUkFFZ1BXcms4ZEtBZUJSN2VjelJ3TEFEQ1Vhc3VwdkFiU3ZlRVRPM2tFQURQeEZnMVlOd0hmYmFHOW5SemcyblFBQTlFT0RWZzBCMmhjd1l0c2xBZ0N3M2hJMFFRQUl1dENTWXdGZ2ZnZDRYamNxUWJBQXVsRDJsbWhGQUlBMmVFSW1DRUJ4Snk0VEFBYnhQUkN3YjZLN2RyMjlHY1kvY3VuUkFHU0VMeHEwekZzaDJ0dVJDUi85eW5mNjBCbUJZd2FOM1IrenQ5T3o4ZWZicnNPUTdKQjVQb3JmNmN6dVR4RGdxUllBdUZhL1ZqS0R4b1NBMlZkQW5pMGViUUZBeHJmQXcxMVcySmdBc0crb0xaTHNiRklBT0lWN2ZZd0JnaUFnbVdIWXBnMEFtYmNBOHpZUUJJYjBFcGEyQXFBQ0FzYnJCeE1DeHMxRXlObXlXd2lBUkd1ODRXTUN3QUF5VWFMcFc3Y0RvT29XaUFaUEVOU3cwUktBS2dpOE44RERla0dRRDBGYkFDb2dFQUQ1QVk1V0VBQlJCZDg4SHdVZ0ExSkdUNG1TbFcvZEdvQ01nRDA3eUFxYlhvWHl1R2dQUUNZRUxBQXllbVQybGhmUC9KMEZ3TDhhczAvWjZLOUFyOWF6K3hNQWZ4VVdBRTlKV3oxa3EvZVhmMTd6S3dpQUYwMlpJY3M0WlpuOXNXOHBmanp6ZHhRQU54b3pncllEQU4waEVBQnZEcGtvQkJrQTZJT1lleXNJQUVCUEx3aFpBQWdDd0RSd2lRQUFoRm9SQUVFQUdBY3NFUUFEa2J6aHIzaTNqdlIyTjNibXJRWGtzWHlKQU5nWUFOMENjVjRFd0lZZndhOHRzMitDVHJlQUFOanNaOUNyZHRrQVZMeSt4Yzl1emc0QzRBQUFNbDZGdWtBZ0FDNEFZSjJvMWE4U3JMNGZrbFQzenpuVGJic0lnQ1FBWm9WSEVBZ0Ftd0l2cTFrQk9nV0EwMStGZEFNa0FEQXIvSTlSV0JBL1N6TjdwdENwOXVaaEFmQWtEaXM0SzRTRk5jdnAzd01DZ0F6QUN1SFhyMEw0ZlNFQS90V0tkV0t1QW9BZ3dDQVFBRVFBVmdxL3ZnY0VBS2JBeDhmSGlhZi84L0NzK1U3OEh0QU5RQUpneGROZnQ4RDRER3dQQU90MFhCa0FmUS9jZ3lBQXZyNit4dWZFK3hXcmgxODNnUUM0VktETDZTOEFCTUF2QmJxRlh4QmNROUQyRmFnckFQb2UrQWxDU3dBNmgxODNnUUE0L25kLzVLT2VkUWc4MTlybHg0QWZQU05pbmJTR1pmeU9aci82eU5KaVp3aVdld1VhbVJJTjNtaC9GUFpvSDJpZDdIVXNQZEErVjlOdE9nQldBeUlDV212ZG1ScnBBUTFLMVRxV0p0NStaMnM1QllDSTZCSEJJblYzdnVaSDRXVHBNcW96K3ZPSXQ2Tzlidzh6NzRQVzUxZ2llMFdhWGQrcVYvVjZsajZzdnIwK1crdW4zd0JzWWIzQ3NQcncxcmNhTTJNOVN5Tm03OWw2cHdHUUphWkhFRll2bnRyTU1HVHZ4ZElwbzg4czdla0FaSXZvRVlMVms2ZDJSaGd5OTJScGxkVWoyd01xQUJYaVdRVmc5V1N0bXhXQWluMVptbVgxeXZTQ0JrQ1ZhTmJoV1gxWjYyYVpYN0V2UzdQTVhsbCtoQUdvRnNzeU9LczNTODFNMHl2M1ptbVgzWFBVbXhBQU0wU3lETXpvejFJdjIrenEvUm42VmZRYzhjZ053Q3h4MEdGWi9hSDFLb3llVVlPbFkzYnZYcDljQU13VUJSbVUxUjlTSzl2WTJmdXp0S3lZdytPWEdZRFpnaUJEc25wRWFsVVlPN3NHUzgrS09heWVtUUJZUVlqUmdLd2VSM1VxekZ5cEJrdlhpcGtzM3NFQXJDTEFhRGhXbjZNNkZVYXVWSU9sYTlWTXFIOFFBQ3NOLzI0d1ZwK29lRlZtcmxLSHBXL1ZQSWlQeXdPQURQRVFsR1dRcFdhVm1idldZWG5pbVIveGNRaEE5UUJJMDFkaXNQcjAxdmNZMVBFWmxrK29kaU0vM3dKUTFleW9TV1JZVnErTVhwQit0WWIzTHlVZWFmbk8wNmtBc01LbThJOGlzUGFmcy95N205SUZRR1pUck9EcjNYL3RZRnU3bTVHNTJ4c2dxeG1GM3hxTFh1dXJjM2NKUUhVVEVZdFp2YkxCak16VS9WbVdwNjg2WG5uOEM0REs0bEdqV2IwcS9GRW4rTSt6dkIxQlVBSkFWc0JZSW1YMXg0OUZyeDFaL2o2cjl1cjFEd0FxQ2xvc3pPaG5kQ0pZK3ROYTdLZk15QUdUa1lIbmZsSUI4QXllTWZDN29IcDY3Qjc4aUVjZXZTUDFycndxQVdDRlFVZEI5ZlE0MnZQa1AyY0YwYU03cS9hM1A1Y0FNQXU4RmhtRmdsMTdWTy94NXg0ajBMMVBXNWZoa1VWL2R2MUg3ZjllZ1pnRlpnNkdCcy9TSTdybnFldVkyWWg4Z3pIN1NBUEFFaXptUU5id1dmcTA3bjNTK2dxUExGNncrcGtPQUdzUVQ5Z3NnbnYyUCtXWlNvOVFUMWc5L1FDQXZla29BS3g2b3pwM2Y0Nks3ZDMvaE9kbWVJVDZ3dXJ0dTk2ZmJ3RG1ob2o1ckhwSXJjZzdwMmYvVTU2WjRWRUxBR1lJK3h4S1ZPUlRndXlaWTZaSGlEK3MvcWczQU5JNDg3YnhHS3RuMWxlZ01rZmxBTERJWGQ5R2RSaFJBSUdBa2FVL0FEQTIraDYycXVtSXNIcDJEd1Vxc3lRQTlzaEVxeTZQQklCMTA3UktRdU5oUnhDdzhsUjJBN0FhYnB5SlZxTUxnRloyYTFqcjM5ZXdEbFRLRFRDaVZUOS9LdUJXQmFveVJRRUErUldJUmF4VlNLM2ZVNEVSQUt3OENZQTk4M0Y4MXdMZ2VJczE0RHNGamdOQTN3RUtQS3JBS1B6TUxOSCthZERLcGxFaHRXNVBCYXF5cEg4V2FNOThITi8xbGdBZ3Z3UXhyeTV2Q2hCeHZYdWY4QnpyMXhXdkZvZy9yQjZwTjhBT0FDRGllbzA3NlRsV3dEeWFJQjZ4K3BzQ3dLeGJBQkhXWTlpcHo3QkNadEVIOVlqVm13Q3d1Tk5zTFN0a0Z0bW1BY0E4bGF1SFFBUkdlMEwyNnJTbUVnTFVJMVpQajNwVC84VllyR0VpZjZIU0tkQ2VXVmZ5aU5uTEVnQXdiNTRyYzlGVHhST01Uczh3Zy9lcW04VWpaaCsvQUdDSGNkWmdENEV0OVR1RjJUc3JNM3dlajVqMW43T1I5cTlIOXdTUU1hU25yamNVSForYjVSR2o3aFY0YVFDZ2Z5OXdGU0xQc0FwK0xZNlZIbmxxb2QrRjZmK0pwR2d3NzRhUDdsc2JsL09yWmZtVUdmNC9oL1NyTmV5Q2tac2dNelk3ejdsejd4WlBLK1lzKzgra3JuUmlad2hiQ2ZydS9TTVFaTXg0bGNFeUFDb0Q4azdnREdGbnpIYktIS3h2UUFRcUdBRDJUNkxQemMyOENiSkNjeElBTTJaNXprZVdSM2U1dTd3Qk1nSHcvQWFNMEQzajFKOHhTMFZZWnN5VkZmelJMTGNBVkVCUWNkcGtDMXN4d3gzY0o4dzJlNGJwQUdRRnFFTFlyTjR0Tjk3T2M2N1ErMXNBcW02QlY4Tzkzd2xWZ282dVZVdUFHV3QzbWJ1NlQrU0FHZ0l3QzRLcllIeURNVVBFdTE0WTRXWHRzWkl1Sy9VeTBoY0NZQ1VJUmdOVi9ibjNsc3JxYjVYUVpjMW4zUmYxQndaQUVQeHZBU3F1MWJUb2VrSHdWMEdMUHdMQW1EcUx1TWF0S2NzRlFTSUEzVytCMWNQL0lLZ3pCRmFQVERkQVo0R3R3bEtPODhBbUhTSHdlT1FDb050TjRCRTJrRjNhbzUwZzhIcmtCcURMYmVBVmxwYmk0RWFuUXhEMUp3ekF5YmRCVk54Z2RtbVBud29Cd3g4S0FLZEJ3QkNXbGw3aVJpZUJ3UEtJQnNBcEVMQ0VKZWFXdXRVSkVEQTlvZ0t3ODNjQlUxUnFZcE0yMnhHRURJOVNBTmdOaEF4aGszSkwzWFlYQ0RMOVNRVmdkUkF5aGFVbU5YbXpWVUdvOEtjRWdOVkFxQkEyT2JNcDI2OENRcVUvcFFBOHUxWXRkcVdvS2VrczNyU0xQOU1BcUlCQm9lZFFrd1hEQ3Y0c0FjQ2RUUmJoVnhDVEU3Yzlkam5GbTM4QTAraVJBa1AwdnFnQUFBQUFTVVZPUks1Q1lJST0nOw0KICBsZXQgZW1iZWRJY29uID0gJ2RhdGE6aW1hZ2UvcG5nO2Jhc2U2NCxpVkJPUncwS0dnb0FBQUFOU1VoRVVnQUFBTm9BQUFCb0NBWUFBQUNYSCs2bEFBQUFBWE5TUjBJQXJzNGM2UUFBQ0JwSlJFRlVlRjd0bmUxMkdqRU1STXY3UDNSNm9HZFRRbmJYbzgrUmJmVXZNbGhYYzIwZ1RmdjQwMytXSlBEMTlmV0ZOUFo0UEI1SVhkZllDRFJrRzc5eXExSEJQamZld3NXT3NrV0w1WnY2N0ZySmprMjJiSEhqbWxhMHExRHRHQmFyWUJWdnQ5WG1PNVZvMGtEdElwMlV5K2pjWm5HVDlzSGE1NGpmMmVOVGlDWWR3SHVqTXcxRE0wQUxtN3ZYeStabTZTTjdyNW81bFJmTk1vRFZoZk5pY3hXY2pBQjc5WkN4VjQxZzM1OS9MWXNqMTNvTllGWFpJdmhrZjFhTDZLR3FjQ1Z2dElnQnJQYk5XaVNqak1NcGN2OFZaU3NuV3VRQW5nR3FPQVROTzROb1R0RUhVL1QrcTgyNWxHalI4S1BEb3hGR3N5YUxVeFN2clAxWGtxMk1hRm53VjdqVk1sbEY4TXJjZnhYWlNvaVdDVDdxbE5iY1RKbzFzN09hZmYrYW1iME9LKzFDcjNVTThCR250QmVQMGZNd2VIbmVDb3o5VjVnM1ZUUVc5QXJnUjBKZFBjNWd0b0pvN0puVFJHTUVKdnZuUkZxWktrbm1HZENkWjA0UnJRSnd6d0I1QzlXaXhSTDF2S0hSbmFhTFZrV3lGZzJMaUdjb2Q1NTlxbWlWUU04bUdvdmRxcUpseno5Tk5GWlE3czV0enhCaDk0Tytpc1hQa3hHcmh3b1pTQkZ0WjhCNnRYNnVaREQwbE96b2h0SEhhQVlSZmY3NjRtMjBDZXZqRmNGbXYyMllsV0ZFQUhmTlEraU50aXRVcTFpZjYxa2NJMFI3OXNicVp6U1hxSDVmQi92b3hiV1BWNFhadHhrMjBjalE3WmlORU5GMkJJbkZWMTdGWWhrcFd1VmJMZW9nZGhlTkZRdzB3dEVCUXZlQjFyRjRSbk5pOVlWeTkrN2ZWYlRkNEtGRDA5YXhlSHFIN0twL1ZuL29QRHc1dUltMkV6UjBVTlk2RmxQUGdJMFlzSG9jN2V0NDNJdUZpMmk3d0VLSDQxWEg0T29WTEFrRFJwK1MvWGt3TVl1MkF5VEpVTHhxV1Z3OVFxVmh3T29YM2F1VmkwbTAxZUdnUTRpb1k3RzFCc3JDZ3RVenVtY0xHN1ZvSzBOQndVZldNZmhhZ3VURmd0RzNaTzlhUmlyUlZvVWhBUjVaeStLckRaRTNDMWIvYUI4YVRtTFJWb1NBQXM2cVl6SFdCQ2lLQ1lzQjJvK1VsVWkwMVpwSG9XYldzUmhMZzVQQmhNVUM3VTNDREJadHBhWlJrSXc2Rm1kSmFESzVzSGlnUGFMY0lORldhUmFGeDZ4anNVWUR3MkREWW9MMmlyQWJpclpDa3lnd2RoMkxOUktVWGRtZ2ZZOFkzb3JHR3J4WGMranpWS2xqOFI2RlpIYythUDkzSEM5Rll3M2RveW4wT2FyVk1aalBJdGt4S3dZalNVNnVlSjZLTm1zekVpRFZhbG5NWnhQdE9UY1dLelF6WjB4L2lUWmpFeWlBeW5VczdqT0tOcU5zVTRrMmF5Z1F3Um1pemM2VHdReVo1YlBtayswUDBXYmFPTnJ3REhVczdyT0xWdjFtZStmN0xScHIySWdJS3dUaXJrOFcrMVc0c3ZoSnN2c1NiWWFOSWszTldNTml2NHBrTTN3YitXUmRXclRWd25CMkVMUm9mc2NqaStXb2c5S2k3U0FaODkzRXFud3J5dllTcmVyR1JxZkVDbyt6Mks4cVdlVzNrZVZFV3owRTd3ZEVpeFozWExMWVhuVlVTclNkSkdPOWJkeUpjU1haeW9pMlV3QllrcDM5SURYdVRxbnh6RlZrYTlGSWVXQUZvQTgwenNETGlMYmJhY3NRclNYalNQYktObVBnZCszdUVBWVc4eDNZVnYzbXNaeG9POXhzTFZyc3pjTGllM3VCTUQrWTczaXpzVUt3eTIzRzRqdktjdjhWck5qRDlkZXpzNEt3ZzJnc3RxTUlsZjRyV01mbVZ3c0lLd3lyY2Z3TU40dnJTTExqbzFEL21neEN5cW1HRllhV3pHbUFpcWM1MlBjdmZpcmdhWmUwYUZweTErdFlUSkZPVG4veHMrclhvdThOelg0eU0wSXhPN083UURONElvS2RmWE0rMWI4Wk12TlgvNnhRckNvYWk2ZWJhRlcvN3AvOVptTUZZMFhSV0N5MWtyMHVpS3ZGTXphRGdtRFVNWGkyWlBtVHZtTGUveVI0d2l3WWtzMzhObnZGdzcvL2s0c1dMWUdBL1NWWWh4VzY4OUc3aDZGby9aa05SWDFleHdySWFQQzJybkpYc3hpaVhTS3NJZEZhTmhUNTd6cFdTSkRoNjd2S1c4bmloM2FJY29aRmE5bFE5RC9yV0VGQkE2RHJLbWNWaXgzYW5ZU3hTTFNXRFIzQnZ6cFdVQ1FCa0hXVVY4MWloM1lvWlN3V2pSbWdLQWpvODBycldHR1Joa0RhVjNROWl4dmFsNGF2U3JTV0RSc0pJekNhRUdEZDVGUXhtRWs2MC9KVmk5YXkzWStIRlJodEVDUmhpNnBsTVVQN3NiQTFpZGF5WFkrSUZScExHTkRBUmRTeGVLRzlXTG1hUld2WnprZkZDSTQxREdqb3ZPc1lyQ1E5ZUhCMUVhMWwremsyVm5BOEFpRUpvRWN0aXhXNmR5K21icUsxYlA5SHh3cVBWeWpRRUZycldKelFmWHZ5ZEJXdFpldWZuYUVoM2tteUp4TjMwYXJMNW5sS25ZV0tGYURvdmxDQjBEb1dKMlIvRVN4RFJOdFpObGFBSXNLQmhGSlR3MktFN0RXS1k1aG9sV1dMZ3NrS1VGUS9TREExTlN4T283MUdjZ3dWYlRmWldBR0tETWdvbk5MSFdZeEcrNHhtR0M1YVZka2l3REpDRk5ISEtKU1d4eG1NUnZ2TllKZ2kyZzZ5c1FLVUVaSlJVTkhIV1l6dTlwZkZMMDIwaXJKNVFtYUZ5TE1IVkJodEhZdlIxWDR6MmFXS1ZrMDJUOUNNRUhudVh5dVBaQjJEVVFYSm5udElGNjJTYkY1QlpRWElhLzhTV1N5MUxFNmZlMlp3bzRoV1JUWXY0S3dBZWUzZklvOWtMWXZUK3g1WnpHaWlzV1h6Qk00SWtPZitKYkpZYXhtc2pqMHptVkZGWThybUNaMFJIcy85VytXUnJHZXdlbjFHZWp5b1dhZSsrREVnQm54UDhMUHZYeUtLdFhaWFZpVkV5NzdaUENYTDNudUYwM2ttMmJ4bnJlMjlqR2laZ2ZXR24zMUtlKzlmR3g3dHVpeGVsVGlWRWkxRHRpajRPNFpISzlyTWM5YjJYRTYwNkNHMGFOcW8rSzZMUEppaVptd2hVRkswS05taUJ4QVpuZ3BmVVZ1Q2RyWTJnbGYwakxVTXlvcm0vWTFreGdBaWd2TSsySXdldEVIU3J2TmlWcDFOZWRHc3QxdjJBTHlDOHhuYzdENjA0bWpYV2JqTndHWUswYlMzRzJzQWx0Q2NCWlhWaDFZYTdUb3B0NW00VENYYSt3Q3ZobElCdmpRd28yQlc2R20wUisvSEs4OVgwK3Uwb21tYXpWNWpGVzVId2JKbmxQVjZMVm93YWExc0xWbndZSktmdmtWTEFvNEsxNElsRFNUNVpmNENyQzJ3aGIwNDV5SUFBQUFBU1VWT1JLNUNZSUk9JzsNCg0KICBsZXQgZXhwZXJpbWVudHNEaXNhYmxlZCA9IHRydWU7DQogIGxldCB3ZWJob29rSGlkZGVuID0gdHJ1ZTsNCiAgbGV0IGVtYmVkSGlkZGVuID0gdHJ1ZTsNCg0KICBjb25zdCBsYWJlbCA9IChuYW1lLCBoaWRkZW4pID0+ICh7DQogICAgYmxvY2tUeXBlOiBTY3JhdGNoLkJsb2NrVHlwZS5MQUJFTCwNCiAgICB0ZXh0OiBuYW1lLA0KICAgIGhpZGVGcm9tUGFsZXR0ZTogaGlkZGVuDQogIH0pOw0KDQogIGFzeW5jIGZ1bmN0aW9uIGNyZWF0ZU5ld1dlYmhvb2soKSB7DQogICAgbGV0IG5hbWUgPSBwcm9tcHQoJ0VudGVyIFdlYmhvb2sgTmFtZScpOw0KICAgIGlmICghbmFtZSkgew0KICAgICAgcmV0dXJuOw0KICAgIH0NCiAgICBsZXQgdXJsID0gcHJvbXB0KCdFbnRlciBXZWJob29rIFVSTCcpOw0KICAgIGlmICghdXJsKSB7DQogICAgICByZXR1cm47DQogICAgfQ0KICAgIGNvbnN0IHdlYmhvb2tEYXRhID0gYXdhaXQgU2NyYXRjaC5mZXRjaCh1cmwpOw0KICAgIGNvbnN0IGpzb25EYXRhID0gYXdhaXQgd2ViaG9va0RhdGEuanNvbigpOw0KICAgIGNvbnN0IHdlYmhvb2tOYW1lID0ganNvbkRhdGFbJ25hbWUnXTsNCiAgICB3ZWJob29rc1tuYW1lXSA9IHtVUkw6IHVybCxVU0VSTkFNRTogd2ViaG9va05hbWUsQVZBVEFSOiAnJ307DQogICAgd2ViaG9va0hpZGRlbiA9IGZhbHNlOw0KICAgIFNjcmF0Y2gudm0uZXh0ZW5zaW9uTWFuYWdlci5yZWZyZXNoQmxvY2tzKCk7DQogIH0NCg0KICBmdW5jdGlvbiBjcmVhdGVOZXdFbWJlZCgpIHsNCiAgICBsZXQgbmFtZSA9IHByb21wdCgnRW50ZXIgRW1iZWQgTmFtZScpOw0KICAgIGlmICghbmFtZSkgew0KICAgICAgcmV0dXJuOw0KICAgIH0NCiAgICBlbWJlZHNbbmFtZV0gPSB7DQogICAgICAidGl0bGUiOiAiVGl0bGUiLA0KICAgICAgImRlc2NyaXB0aW9uIjogIkRlc2NyaXB0aW9uIiwNCiAgICAgICJ1cmwiOiBudWxsLA0KICAgICAgImNvbG9yIjogbnVsbCwNCiAgICAgICJhdXRob3IiOiBudWxsLA0KICAgICAgImltYWdlIjogeyJ1cmwiOiBudWxsfSwNCiAgICAgICJ0aHVtYm5haWwiOiB7InVybCI6IG51bGx9fTsNCiAgICBlbWJlZEhpZGRlbiA9IGZhbHNlOw0KICAgIFNjcmF0Y2gudm0uZXh0ZW5zaW9uTWFuYWdlci5yZWZyZXNoQmxvY2tzKCk7DQogIH0NCg0KICBsZXQgd2ViaG9va3MgPSBPYmplY3QuY3JlYXRlKG51bGwpOw0KICBsZXQgZW1iZWRzID0gT2JqZWN0LmNyZWF0ZShudWxsKTsNCg0KICBjbGFzcyBEaXNjb3JkQVBJIHsNCiAgICBnZXRJbmZvKCkgew0KICAgICAgcmV0dXJuIHsNCiAgICAgICAgaWQ6ICdsbXNkaXNjb3JkYXBpJywNCiAgICAgICAgbmFtZTogJ0Rpc2NvcmQgQVBJJywNCiAgICAgICAgY29sb3IxOiAnIzU4NmFlYScsDQogICAgICAgIGNvbG9yMjogJyM0YjVhZDInLA0KICAgICAgICBjb2xvcjM6ICcjMzc0N2JkJywNCiAgICAgICAgbWVudUljb25VUkk6IGRpc2NvcmRJY29uLA0KICAgICAgICBibG9ja3M6IFsNCiAgICAgICAgICB7DQogICAgICAgICAgICBvcGNvZGU6ICdzZW5kQmFzaWNNZXNzYWdlJywNCiAgICAgICAgICAgIGJsb2NrVHlwZTogU2NyYXRjaC5CbG9ja1R5cGUuQ09NTUFORCwNCiAgICAgICAgICAgIHRleHQ6ICdzZW5kIFtUWVBFXSBbU1RSSU5HXSB0byB1cmwgW1dFQkhPT0tdJywNCiAgICAgICAgICAgIGFyZ3VtZW50czogew0KICAgICAgICAgICAgICBUWVBFOiB7DQogICAgICAgICAgICAgICAgdHlwZTogU2NyYXRjaC5Bcmd1bWVudFR5cGUuU1RSSU5HLA0KICAgICAgICAgICAgICAgIG1lbnU6ICdzZW5kVHlwZU1lbnUnLA0KICAgICAgICAgICAgICAgIGRlZmF1bHRWYWx1ZTogJ3RleHQnDQogICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgIFNUUklORzogew0KICAgICAgICAgICAgICAgIHR5cGU6IFNjcmF0Y2guQXJndW1lbnRUeXBlLlNUUklORywNCiAgICAgICAgICAgICAgICBkZWZhdWx0VmFsdWU6ICdIZWxsbyEnDQogICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgIFdFQkhPT0s6IHsNCiAgICAgICAgICAgICAgICB0eXBlOiBTY3JhdGNoLkFyZ3VtZW50VHlwZS5TVFJJTkcNCiAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfQ0KICAgICAgICAgIH0sDQogICAgICAgICAgew0KICAgICAgICAgICAgZnVuYzogJ2VuYWJsZUV4cGVyaW1lbnRhbCcsDQogICAgICAgICAgICBibG9ja1R5cGU6IFNjcmF0Y2guQmxvY2tUeXBlLkJVVFRPTiwNCiAgICAgICAgICAgIHRleHQ6ICdFbmFibGUgRXhwZXJpbWVudGFsIEZlYXR1cmVzJywNCiAgICAgICAgICAgIGhpZGVGcm9tUGFsZXR0ZTogIWV4cGVyaW1lbnRzRGlzYWJsZWQNCiAgICAgICAgICB9LA0KDQogICAgICAgICAgJy0tLScsDQoNCiAgICAgICAgICBsYWJlbCgnV2ViaG9va3MnLCBleHBlcmltZW50c0Rpc2FibGVkKSwNCg0KICAgICAgICAgIHsNCiAgICAgICAgICAgIG9wY29kZTogJ2FkZFdlYmhvb2snLA0KICAgICAgICAgICAgYmxvY2tUeXBlOiBTY3JhdGNoLkJsb2NrVHlwZS5CVVRUT04sDQogICAgICAgICAgICB0ZXh0OiAnQWRkIFdlYmhvb2snLA0KICAgICAgICAgICAgZnVuYzogJ2FkZFdlYmhvb2snLA0KICAgICAgICAgICAgZGlzYWJsZU1vbml0b3I6IHRydWUsDQogICAgICAgICAgICBoaWRlRnJvbVBhbGV0dGU6IGV4cGVyaW1lbnRzRGlzYWJsZWQNCiAgICAgICAgICB9LA0KICAgICAgICAgIHsNCiAgICAgICAgICAgIG9wY29kZTogJ2RlbGV0ZVdlYmhvb2snLA0KICAgICAgICAgICAgYmxvY2tUeXBlOiBTY3JhdGNoLkJsb2NrVHlwZS5CVVRUT04sDQogICAgICAgICAgICB0ZXh0OiAnUmVtb3ZlIFdlYmhvb2snLA0KICAgICAgICAgICAgZnVuYzogJ2RlbGV0ZVdlYmhvb2snLA0KICAgICAgICAgICAgZGlzYWJsZU1vbml0b3I6IHRydWUsDQogICAgICAgICAgICBoaWRlRnJvbVBhbGV0dGU6IHdlYmhvb2tIaWRkZW4NCiAgICAgICAgICB9LA0KICAgICAgICAgIHsNCiAgICAgICAgICAgIG9wY29kZTogJ3NldFdlYmhvb2tBdHRyaWJ1dGUnLA0KICAgICAgICAgICAgYmxvY2tUeXBlOiBTY3JhdGNoLkJsb2NrVHlwZS5DT01NQU5ELA0KICAgICAgICAgICAgYmxvY2tJY29uVVJJOiB3ZWJob29rSWNvbiwNCiAgICAgICAgICAgIHRleHQ6ICdzZXQgW0FUVFJJQlVURV0gZm9yIFtXRUJIT09LXSB0byBbU1RSSU5HXScsDQogICAgICAgICAgICBhcmd1bWVudHM6IHsNCiAgICAgICAgICAgICAgQVRUUklCVVRFOiB7DQogICAgICAgICAgICAgICAgdHlwZTogU2NyYXRjaC5Bcmd1bWVudFR5cGUuU1RSSU5HLA0KICAgICAgICAgICAgICAgIG1lbnU6ICd3ZWJob29rQXR0cmlidXRlTWVudScNCiAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAgV0VCSE9PSzogew0KICAgICAgICAgICAgICAgIHR5cGU6IFNjcmF0Y2guQXJndW1lbnRUeXBlLlNUUklORywNCiAgICAgICAgICAgICAgICBtZW51OiAnd2ViaG9va01lbnUnDQogICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgIFNUUklORzogew0KICAgICAgICAgICAgICAgIHR5cGU6IFNjcmF0Y2guQXJndW1lbnRUeXBlLlNUUklORywNCiAgICAgICAgICAgICAgICBkZWZhdWx0VmFsdWU6ICdHYXJib011ZmZpbicNCiAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgIGhpZGVGcm9tUGFsZXR0ZTogd2ViaG9va0hpZGRlbg0KICAgICAgICAgIH0sDQogICAgICAgICAgew0KICAgICAgICAgICAgb3Bjb2RlOiAnc2VuZE1lc3NhZ2UnLA0KICAgICAgICAgICAgYmxvY2tUeXBlOiBTY3JhdGNoLkJsb2NrVHlwZS5DT01NQU5ELA0KICAgICAgICAgICAgYmxvY2tJY29uVVJJOiB3ZWJob29rSWNvbiwNCiAgICAgICAgICAgIHRleHQ6ICdzZW5kIFtUWVBFXSBbU1RSSU5HXSB0byBbV0VCSE9PS10gZW1iZWQgW0VNQkVEXScsDQogICAgICAgICAgICBhcmd1bWVudHM6IHsNCiAgICAgICAgICAgICAgVFlQRTogew0KICAgICAgICAgICAgICAgIHR5cGU6IFNjcmF0Y2guQXJndW1lbnRUeXBlLlNUUklORywNCiAgICAgICAgICAgICAgICBtZW51OiAnc2VuZFR5cGVNZW51JywNCiAgICAgICAgICAgICAgICBkZWZhdWx0VmFsdWU6ICd0ZXh0Jw0KICAgICAgICAgICAgICB9LA0KICAgICAgICAgICAgICBTVFJJTkc6IHsNCiAgICAgICAgICAgICAgICB0eXBlOiBTY3JhdGNoLkFyZ3VtZW50VHlwZS5TVFJJTkcsDQogICAgICAgICAgICAgICAgZGVmYXVsdFZhbHVlOiAnSGVsbG8hJw0KICAgICAgICAgICAgICB9LA0KICAgICAgICAgICAgICBXRUJIT09LOiB7DQogICAgICAgICAgICAgICAgdHlwZTogU2NyYXRjaC5Bcmd1bWVudFR5cGUuU1RSSU5HLA0KICAgICAgICAgICAgICAgIG1lbnU6ICd3ZWJob29rTWVudScNCiAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAgRU1CRUQ6IHsNCiAgICAgICAgICAgICAgICB0eXBlOiBTY3JhdGNoLkFyZ3VtZW50VHlwZS5TVFJJTkcsDQogICAgICAgICAgICAgICAgbWVudTogJ2VtYmVkTWVudScNCiAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgIGhpZGVGcm9tUGFsZXR0ZTogd2ViaG9va0hpZGRlbg0KICAgICAgICAgIH0sDQogICAgICAgICAgew0KICAgICAgICAgICAgb3Bjb2RlOiAnZ2V0V2ViaG9va0F0dHJpYnV0ZScsDQogICAgICAgICAgICBibG9ja1R5cGU6IFNjcmF0Y2guQmxvY2tUeXBlLlJFUE9SVEVSLA0KICAgICAgICAgICAgYmxvY2tJY29uVVJJOiB3ZWJob29rSWNvbiwNCiAgICAgICAgICAgIHRleHQ6ICdbQVRUUklCVVRFXSBmb3IgW1dFQkhPT0tdJywNCiAgICAgICAgICAgIGFyZ3VtZW50czogew0KICAgICAgICAgICAgICBBVFRSSUJVVEU6IHsNCiAgICAgICAgICAgICAgICB0eXBlOiBTY3JhdGNoLkFyZ3VtZW50VHlwZS5TVFJJTkcsDQogICAgICAgICAgICAgICAgbWVudTogJ3dlYmhvb2tBdHRyaWJ1dGVNZW51Jw0KICAgICAgICAgICAgICB9LA0KICAgICAgICAgICAgICBXRUJIT09LOiB7DQogICAgICAgICAgICAgICAgdHlwZTogU2NyYXRjaC5Bcmd1bWVudFR5cGUuU1RSSU5HLA0KICAgICAgICAgICAgICAgIG1lbnU6ICd3ZWJob29rTWVudScNCiAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgIGhpZGVGcm9tUGFsZXR0ZTogd2ViaG9va0hpZGRlbg0KICAgICAgICAgIH0sDQoNCiAgICAgICAgICAnLS0tJywNCg0KICAgICAgICAgIGxhYmVsKCdFbWJlZHMnLCBleHBlcmltZW50c0Rpc2FibGVkKSwNCg0KICAgICAgICAgIHsNCiAgICAgICAgICAgIG9wY29kZTogJ2NyZWF0ZUVtYmVkJywNCiAgICAgICAgICAgIGJsb2NrVHlwZTogU2NyYXRjaC5CbG9ja1R5cGUuQlVUVE9OLA0KICAgICAgICAgICAgdGV4dDogJ0NyZWF0ZSBFbWJlZCcsDQogICAgICAgICAgICBmdW5jOiAnY3JlYXRlRW1iZWQnLA0KICAgICAgICAgICAgZGlzYWJsZU1vbml0b3I6IHRydWUsDQogICAgICAgICAgICBoaWRlRnJvbVBhbGV0dGU6IGV4cGVyaW1lbnRzRGlzYWJsZWQNCiAgICAgICAgICB9LA0KICAgICAgICAgIHsNCiAgICAgICAgICAgIG9wY29kZTogJ2RlbGV0ZUVtYmVkJywNCiAgICAgICAgICAgIGJsb2NrVHlwZTogU2NyYXRjaC5CbG9ja1R5cGUuQlVUVE9OLA0KICAgICAgICAgICAgdGV4dDogJ1JlbW92ZSBFbWJlZCcsDQogICAgICAgICAgICBmdW5jOiAnZGVsZXRlRW1iZWQnLA0KICAgICAgICAgICAgZGlzYWJsZU1vbml0b3I6IHRydWUsDQogICAgICAgICAgICBoaWRlRnJvbVBhbGV0dGU6IGVtYmVkSGlkZGVuDQogICAgICAgICAgfSwNCiAgICAgICAgICB7DQogICAgICAgICAgICBvcGNvZGU6ICdnZXRFbWJlZEF0dHJpYnV0ZScsDQogICAgICAgICAgICBibG9ja1R5cGU6IFNjcmF0Y2guQmxvY2tUeXBlLlJFUE9SVEVSLA0KICAgICAgICAgICAgYmxvY2tJY29uVVJJOiBlbWJlZEljb24sDQogICAgICAgICAgICB0ZXh0OiAnW0FUVFJJQlVURV0gb2YgW0VNQkVEXScsDQogICAgICAgICAgICBhcmd1bWVudHM6IHsNCiAgICAgICAgICAgICAgQVRUUklCVVRFOiB7DQogICAgICAgICAgICAgICAgdHlwZTogU2NyYXRjaC5Bcmd1bWVudFR5cGUuU1RSSU5HLA0KICAgICAgICAgICAgICAgIG1lbnU6ICdlbWJlZEF0dHJpYnV0ZU1lbnUnDQogICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgIEVNQkVEOiB7DQogICAgICAgICAgICAgICAgdHlwZTogU2NyYXRjaC5Bcmd1bWVudFR5cGUuU1RSSU5HLA0KICAgICAgICAgICAgICAgIG1lbnU6ICdlbWJlZE1lbnUnDQogICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICBoaWRlRnJvbVBhbGV0dGU6IGVtYmVkSGlkZGVuDQogICAgICAgICAgfSwNCg0KICAgICAgICAgICctLS0nLA0KDQogICAgICAgICAgew0KICAgICAgICAgICAgb3Bjb2RlOiAnc2V0RW1iZWRBdHRyaWJ1dGUnLA0KICAgICAgICAgICAgYmxvY2tUeXBlOiBTY3JhdGNoLkJsb2NrVHlwZS5DT01NQU5ELA0KICAgICAgICAgICAgYmxvY2tJY29uVVJJOiBlbWJlZEljb24sDQogICAgICAgICAgICB0ZXh0OiAnc2V0IFtBVFRSSUJVVEVdIGZvciBbRU1CRURdIHRvIFtTVFJJTkddJywNCiAgICAgICAgICAgIGFyZ3VtZW50czogew0KICAgICAgICAgICAgICBBVFRSSUJVVEU6IHsNCiAgICAgICAgICAgICAgICB0eXBlOiBTY3JhdGNoLkFyZ3VtZW50VHlwZS5TVFJJTkcsDQogICAgICAgICAgICAgICAgbWVudTogJ2VtYmVkQXR0cmlidXRlTWVudScNCiAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAgRU1CRUQ6IHsNCiAgICAgICAgICAgICAgICB0eXBlOiBTY3JhdGNoLkFyZ3VtZW50VHlwZS5TVFJJTkcsDQogICAgICAgICAgICAgICAgbWVudTogJ2VtYmVkTWVudScNCiAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAgU1RSSU5HOiB7DQogICAgICAgICAgICAgICAgdHlwZTogU2NyYXRjaC5Bcmd1bWVudFR5cGUuU1RSSU5HLA0KICAgICAgICAgICAgICAgIGRlZmF1bHRWYWx1ZTogJ0Fubm91bmNlbWVudCcNCiAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgIGhpZGVGcm9tUGFsZXR0ZTogZW1iZWRIaWRkZW4NCiAgICAgICAgICB9LA0KICAgICAgICAgIHsNCiAgICAgICAgICAgIG9wY29kZTogJ3NldEVtYmVkQ29sb3InLA0KICAgICAgICAgICAgYmxvY2tUeXBlOiBTY3JhdGNoLkJsb2NrVHlwZS5DT01NQU5ELA0KICAgICAgICAgICAgYmxvY2tJY29uVVJJOiBlbWJlZEljb24sDQogICAgICAgICAgICB0ZXh0OiAnc2V0IGNvbG9yIGZvciBbRU1CRURdIHRvIFtDT0xPUl0nLA0KICAgICAgICAgICAgYXJndW1lbnRzOiB7DQogICAgICAgICAgICAgIEVNQkVEOiB7DQogICAgICAgICAgICAgICAgdHlwZTogU2NyYXRjaC5Bcmd1bWVudFR5cGUuU1RSSU5HLA0KICAgICAgICAgICAgICAgIG1lbnU6ICdlbWJlZE1lbnUnDQogICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgIENPTE9SOiB7DQogICAgICAgICAgICAgICAgdHlwZTogU2NyYXRjaC5Bcmd1bWVudFR5cGUuQ09MT1IsDQogICAgICAgICAgICAgICAgZGVmYXVsdFZhbHVlOiAnIzVlZTU5ZCcNCiAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgIGhpZGVGcm9tUGFsZXR0ZTogZW1iZWRIaWRkZW4NCiAgICAgICAgICB9LA0KICAgICAgICAgIHsNCiAgICAgICAgICAgIG9wY29kZTogJ3NldEVtYmVkQXV0aG9yJywNCiAgICAgICAgICAgIGJsb2NrVHlwZTogU2NyYXRjaC5CbG9ja1R5cGUuQ09NTUFORCwNCiAgICAgICAgICAgIGJsb2NrSWNvblVSSTogZW1iZWRJY29uLA0KICAgICAgICAgICAgdGV4dDogJ3NldCBhdXRob3IgW0FUVFJJQlVURV0gZm9yIFtFTUJFRF0gdG8gW1NUUklOR10nLA0KICAgICAgICAgICAgYXJndW1lbnRzOiB7DQogICAgICAgICAgICAgIEFUVFJJQlVURTogew0KICAgICAgICAgICAgICAgIHR5cGU6IFNjcmF0Y2guQXJndW1lbnRUeXBlLlNUUklORywNCiAgICAgICAgICAgICAgICBtZW51OiAnYXV0aG9yTWVudScNCiAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAgRU1CRUQ6IHsNCiAgICAgICAgICAgICAgICB0eXBlOiBTY3JhdGNoLkFyZ3VtZW50VHlwZS5TVFJJTkcsDQogICAgICAgICAgICAgICAgbWVudTogJ2VtYmVkTWVudScNCiAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAgU1RSSU5HOiB7DQogICAgICAgICAgICAgICAgdHlwZTogU2NyYXRjaC5Bcmd1bWVudFR5cGUuU1RSSU5HLA0KICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgaGlkZUZyb21QYWxldHRlOiBlbWJlZEhpZGRlbg0KICAgICAgICAgIH0NCiAgICAgICAgXSwNCiAgICAgICAgbWVudXM6IHsNCiAgICAgICAgICB3ZWJob29rTWVudTogew0KICAgICAgICAgICAgYWNjZXB0UmVwb3J0ZXJzOiB0cnVlLA0KICAgICAgICAgICAgaXRlbXM6ICdjcmVhdGVXZWJob29rTWVudScNCiAgICAgICAgICB9LA0KICAgICAgICAgIGVtYmVkTWVudTogew0KICAgICAgICAgICAgYWNjZXB0UmVwb3J0ZXJzOiB0cnVlLA0KICAgICAgICAgICAgaXRlbXM6ICdjcmVhdGVFbWJlZE1lbnUnDQogICAgICAgICAgfSwNCiAgICAgICAgICBzZW5kVHlwZU1lbnU6IHsNCiAgICAgICAgICAgIGFjY2VwdFJlcG9ydGVyczogZmFsc2UsDQogICAgICAgICAgICBpdGVtczogWw0KICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgdGV4dDogJ3RleHQnLA0KICAgICAgICAgICAgICAgIHZhbHVlOiAndGV4dCcNCiAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgIHRleHQ6ICdqc29uJywNCiAgICAgICAgICAgICAgICB2YWx1ZTogJ2pzb24nDQogICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIF0NCiAgICAgICAgICB9LA0KICAgICAgICAgIHdlYmhvb2tBdHRyaWJ1dGVNZW51OiB7DQogICAgICAgICAgICBhY2NlcHRSZXBvcnRlcnM6IGZhbHNlLA0KICAgICAgICAgICAgaXRlbXM6IFsNCiAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgIHRleHQ6ICd1c2VybmFtZScsDQogICAgICAgICAgICAgICAgdmFsdWU6ICd1c2VybmFtZScNCiAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgIHRleHQ6ICdhdmF0YXIgdXJsJywNCiAgICAgICAgICAgICAgICB2YWx1ZTogJ2F2YXRhcicNCiAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgIHRleHQ6ICd1cmwnLA0KICAgICAgICAgICAgICAgIHZhbHVlOiAndXJsJw0KICAgICAgICAgICAgICB9DQogICAgICAgICAgICBdDQogICAgICAgICAgfSwNCiAgICAgICAgICBlbWJlZEF0dHJpYnV0ZU1lbnU6IHsNCiAgICAgICAgICAgIGFjY2VwdFJlcG9ydGVyczogZmFsc2UsDQogICAgICAgICAgICBpdGVtczogWw0KICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgdGV4dDogJ3RpdGxlJywNCiAgICAgICAgICAgICAgICB2YWx1ZTogJ3RpdGxlJw0KICAgICAgICAgICAgICB9LA0KICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgdGV4dDogJ2Rlc2NyaXB0aW9uJywNCiAgICAgICAgICAgICAgICB2YWx1ZTogJ2Rlc2NyaXB0aW9uJw0KICAgICAgICAgICAgICB9LA0KICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgdGV4dDogJ3VybCcsDQogICAgICAgICAgICAgICAgdmFsdWU6ICd1cmwnDQogICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICB0ZXh0OiAndGh1bWJuYWlsIHVybCcsDQogICAgICAgICAgICAgICAgdmFsdWU6ICd0aHVtYnVybCcNCiAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgIHRleHQ6ICdpbWFnZSB1cmwnLA0KICAgICAgICAgICAgICAgIHZhbHVlOiAnaW1hZ2V1cmwnDQogICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIF0NCiAgICAgICAgICB9LA0KICAgICAgICAgIHN0YXRlTWVudTogew0KICAgICAgICAgICAgYWNjZXB0UmVwb3J0ZXJzOiBmYWxzZSwNCiAgICAgICAgICAgIGl0ZW1zOiBbDQogICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICB0ZXh0OiAnZW5hYmxlZCcsDQogICAgICAgICAgICAgICAgdmFsdWU6ICdlbmFibGVkJw0KICAgICAgICAgICAgICB9LA0KICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgdGV4dDogJ2Rpc2FibGVkJywNCiAgICAgICAgICAgICAgICB2YWx1ZTogJ2Rpc2FibGVkJw0KICAgICAgICAgICAgICB9DQogICAgICAgICAgICBdDQogICAgICAgICAgfSwNCiAgICAgICAgICBhdXRob3JNZW51OiB7DQogICAgICAgICAgICBhY2NlcHRSZXBvcnRlcnM6IGZhbHNlLA0KICAgICAgICAgICAgaXRlbXM6IFsNCiAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgIHRleHQ6ICduYW1lJywNCiAgICAgICAgICAgICAgICB2YWx1ZTogJ25hbWUnDQogICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICB0ZXh0OiAndXJsJywNCiAgICAgICAgICAgICAgICB2YWx1ZTogJ3VybCcNCiAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgIHRleHQ6ICdpY29uIHVybCcsDQogICAgICAgICAgICAgICAgdmFsdWU6ICdpY29udXJsJw0KICAgICAgICAgICAgICB9DQogICAgICAgICAgICBdDQogICAgICAgICAgfSwNCiAgICAgICAgfQ0KICAgICAgfTsNCiAgICB9DQoNCiAgICBzZW5kQmFzaWNNZXNzYWdlKGFyZ3MpIHsNCiAgICAgIGlmICghYXJncy5TVFJJTkcgfHwgIWFyZ3MuV0VCSE9PSykgew0KICAgICAgICByZXR1cm47DQogICAgICB9DQogICAgICBjb25zdCB3ZWJob29rVVJMID0gYXJncy5XRUJIT09LOw0KICAgICAgbGV0IGNvbnRlbnQgPSAnJzsNCiAgICAgIGlmIChhcmdzLlRZUEUgPT09ICd0ZXh0Jykgew0KICAgICAgICBsZXQgbWFwcGVkRW1iZWRzID0gW107DQogICAgICAgIGlmIChlbWJlZHNbYXJncy5FTUJFRF0pIHsNCiAgICAgICAgICBtYXBwZWRFbWJlZHMgPSBbZW1iZWRzW2FyZ3MuRU1CRURdXTsNCiAgICAgICAgfQ0KICAgICAgICBsZXQgZGVmYXVsdERhdGEgPSB7DQogICAgICAgICAgY29udGVudDogYXJncy5TVFJJTkcNCiAgICAgICAgfTsNCiAgICAgICAgY29udGVudCA9IEpTT04uc3RyaW5naWZ5KGRlZmF1bHREYXRhKTsNCiAgICAgIH0gZWxzZSB7DQogICAgICAgIGNvbnRlbnQgPSBhcmdzLlNUUklORzsNCiAgICAgIH0NCiAgICAgIHRyeSB7DQogICAgICAgIFNjcmF0Y2guZmV0Y2god2ViaG9va1VSTCwgew0KICAgICAgICAgIG1ldGhvZDogIlBPU1QiLA0KICAgICAgICAgIGhlYWRlcnM6IHsNCiAgICAgICAgICAgICdDb250ZW50LXR5cGUnOiAnYXBwbGljYXRpb24vanNvbicNCiAgICAgICAgICB9LA0KICAgICAgICAgIGJvZHk6IGNvbnRlbnQNCiAgICAgICAgfSk7DQogICAgICB9IGNhdGNoIChlcnJvcikgew0KICAgICAgICByZXR1cm4gJyc7DQogICAgICB9DQogICAgfQ0KDQogICAgZW5hYmxlRXhwZXJpbWVudGFsKCkgew0KICAgICAgbGV0IGNvbmZpcm1Nc2cgPSAnV2FybmluZzogV2hpbGUgdGhlc2UgZmVhdHVyZXMgYXJlIGZ1bGx5IGZ1bmN0aW9uYWwsIGN1c3RvbSB3ZWJob29rcy9lbWJlZHMgY3VycmVudGx5IGRvIG5vdCBzYXZlIHRvIHByb2plY3RzLiBcbiBcbiBEbyB5b3Ugd2lzaCB0byBjb250aW51ZT8nOw0KICAgICAgaWYgKGNvbmZpcm0oY29uZmlybU1zZykpIHsNCiAgICAgICAgZXhwZXJpbWVudHNEaXNhYmxlZCA9IGZhbHNlOw0KICAgICAgICBTY3JhdGNoLnZtLmV4dGVuc2lvbk1hbmFnZXIucmVmcmVzaEJsb2NrcygpOw0KICAgICAgfQ0KICAgIH0NCg0KICAgIGFkZFdlYmhvb2soKSB7DQogICAgICBjcmVhdGVOZXdXZWJob29rKCk7DQogICAgfQ0KDQogICAgZGVsZXRlV2ViaG9vaygpIHsNCiAgICAgIGxldCBuYW1lID0gcHJvbXB0KCdFbnRlciBXZWJob29rIE5hbWUnKTsNCiAgICAgIGlmICghbmFtZSkgew0KICAgICAgICByZXR1cm47DQogICAgICB9DQogICAgICBSZWZsZWN0LmRlbGV0ZVByb3BlcnR5KHdlYmhvb2tzLCBuYW1lKTsNCiAgICAgIFNjcmF0Y2gudm0uZXh0ZW5zaW9uTWFuYWdlci5yZWZyZXNoQmxvY2tzKCk7DQogICAgICBpZiAoT2JqZWN0LmtleXMod2ViaG9va3MpLmxlbmd0aCA9PSAwKSB7DQogICAgICAgIHdlYmhvb2tIaWRkZW4gPSB0cnVlOw0KICAgICAgICBTY3JhdGNoLnZtLmV4dGVuc2lvbk1hbmFnZXIucmVmcmVzaEJsb2NrcygpOw0KICAgICAgfQ0KICAgIH0NCg0KICAgIHNldFdlYmhvb2tBdHRyaWJ1dGUoYXJncykgew0KICAgICAgaWYgKCF3ZWJob29rc1thcmdzLldFQkhPT0tdKSB7DQogICAgICAgIHJldHVybjsNCiAgICAgIH0NCiAgICAgIGlmIChhcmdzLkFUVFJJQlVURSA9PT0gJ3VybCcpIHsNCiAgICAgICAgd2ViaG9va3NbYXJncy5XRUJIT09LXVsnVVJMJ10gPSBhcmdzLlNUUklORzsNCiAgICAgIH0gZWxzZSBpZiAoYXJncy5BVFRSSUJVVEUgPT09ICdhdmF0YXInKSB7DQogICAgICAgIHdlYmhvb2tzW2FyZ3MuV0VCSE9PS11bJ0FWQVRBUiddID0gYXJncy5TVFJJTkc7DQogICAgICB9IGVsc2Ugew0KICAgICAgICB3ZWJob29rc1thcmdzLldFQkhPT0tdWydVU0VSTkFNRSddID0gYXJncy5TVFJJTkc7DQogICAgICB9DQogICAgfQ0KDQogICAgc2VuZE1lc3NhZ2UoYXJncykgew0KICAgICAgaWYgKCF3ZWJob29rc1thcmdzLldFQkhPT0tdKSB7DQogICAgICAgIHJldHVybjsNCiAgICAgIH0NCiAgICAgIGNvbnN0IHdlYmhvb2tVUkwgPSB3ZWJob29rc1thcmdzLldFQkhPT0tdWydVUkwnXTsNCiAgICAgIGNvbnN0IHdlYmhvb2tVc2VybmFtZSA9IHdlYmhvb2tzW2FyZ3MuV0VCSE9PS11bJ1VTRVJOQU1FJ107DQogICAgICBjb25zdCB3ZWJob29rQXZhdGFyID0gd2ViaG9va3NbYXJncy5XRUJIT09LXVsnQVZBVEFSJ107DQogICAgICBsZXQgY29udGVudCA9ICcnOw0KICAgICAgaWYgKGFyZ3MuVFlQRSA9PT0gJ3RleHQnKSB7DQogICAgICAgIGxldCBtYXBwZWRFbWJlZHMgPSBbXTsNCiAgICAgICAgaWYgKGVtYmVkc1thcmdzLkVNQkVEXSkgew0KICAgICAgICAgIG1hcHBlZEVtYmVkcyA9IFtlbWJlZHNbYXJncy5FTUJFRF1dOw0KICAgICAgICB9DQogICAgICAgIGxldCBkZWZhdWx0RGF0YSA9IHsNCiAgICAgICAgICB1c2VybmFtZTogd2ViaG9va1VzZXJuYW1lLA0KICAgICAgICAgIGF2YXRhcl91cmw6IHdlYmhvb2tBdmF0YXIsDQogICAgICAgICAgY29udGVudDogYXJncy5TVFJJTkcsDQogICAgICAgICAgZW1iZWRzOiBtYXBwZWRFbWJlZHN9Ow0KICAgICAgICBjb250ZW50ID0gSlNPTi5zdHJpbmdpZnkoZGVmYXVsdERhdGEpOw0KICAgICAgfSBlbHNlIHsNCiAgICAgICAgY29udGVudCA9IGFyZ3MuU1RSSU5HOw0KICAgICAgfQ0KICAgICAgdHJ5IHsNCiAgICAgICAgU2NyYXRjaC5mZXRjaCh3ZWJob29rVVJMLCB7DQogICAgICAgICAgbWV0aG9kOiAiUE9TVCIsDQogICAgICAgICAgaGVhZGVyczogew0KICAgICAgICAgICAgJ0NvbnRlbnQtdHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJw0KICAgICAgICAgIH0sDQogICAgICAgICAgYm9keTogY29udGVudA0KICAgICAgICB9KTsNCiAgICAgIH0gY2F0Y2ggKGVycm9yKSB7DQogICAgICAgIHJldHVybiAnJzsNCiAgICAgIH0NCiAgICB9DQoNCiAgICBnZXRXZWJob29rQXR0cmlidXRlKGFyZ3MpIHsNCiAgICAgIGlmICghd2ViaG9va3NbYXJncy5XRUJIT09LXSkgew0KICAgICAgICByZXR1cm4gJyc7DQogICAgICB9DQogICAgICBpZiAoYXJncy5BVFRSSUJVVEUgPT09ICd1cmwnKSB7DQogICAgICAgIHJldHVybiB3ZWJob29rc1thcmdzLldFQkhPT0tdWydVUkwnXTsNCiAgICAgIH0gZWxzZSBpZiAoYXJncy5BVFRSSUJVVEUgPT09ICdhdmF0YXInKSB7DQogICAgICAgIHJldHVybiB3ZWJob29rc1thcmdzLldFQkhPT0tdWydBVkFUQVInXTsNCiAgICAgIH0gZWxzZSB7DQogICAgICAgIHJldHVybiB3ZWJob29rc1thcmdzLldFQkhPT0tdWydVU0VSTkFNRSddOw0KICAgICAgfQ0KICAgIH0NCg0KICAgIGNyZWF0ZUVtYmVkKCkgew0KICAgICAgY3JlYXRlTmV3RW1iZWQoKTsNCiAgICB9DQoNCiAgICBkZWxldGVFbWJlZCgpIHsNCiAgICAgIGxldCBuYW1lID0gcHJvbXB0KCdFbnRlciBFbWJlZCBOYW1lJyk7DQogICAgICBpZiAoIW5hbWUpIHsNCiAgICAgICAgcmV0dXJuOw0KICAgICAgfQ0KICAgICAgUmVmbGVjdC5kZWxldGVQcm9wZXJ0eShlbWJlZHMsIG5hbWUpOw0KICAgICAgU2NyYXRjaC52bS5leHRlbnNpb25NYW5hZ2VyLnJlZnJlc2hCbG9ja3MoKTsNCiAgICAgIGlmIChPYmplY3Qua2V5cyhlbWJlZHMpLmxlbmd0aCA9PSAwKSB7DQogICAgICAgIGVtYmVkSGlkZGVuID0gdHJ1ZTsNCiAgICAgICAgU2NyYXRjaC52bS5leHRlbnNpb25NYW5hZ2VyLnJlZnJlc2hCbG9ja3MoKTsNCiAgICAgIH0NCiAgICB9DQoNCiAgICBzZXRFbWJlZEF0dHJpYnV0ZShhcmdzKSB7DQogICAgICBpZiAoIWVtYmVkc1thcmdzLkVNQkVEXSkgew0KICAgICAgICByZXR1cm47DQogICAgICB9DQogICAgICBpZiAoYXJncy5BVFRSSUJVVEUgPT09ICd0aXRsZScpIHsNCiAgICAgICAgZW1iZWRzW2FyZ3MuRU1CRURdWyd0aXRsZSddID0gYXJncy5TVFJJTkc7DQogICAgICB9IGVsc2UgaWYgKGFyZ3MuQVRUUklCVVRFID09PSAnZGVzY3JpcHRpb24nKSB7DQogICAgICAgIGVtYmVkc1thcmdzLkVNQkVEXVsnZGVzY3JpcHRpb24nXSA9IGFyZ3MuU1RSSU5HOw0KICAgICAgfSBlbHNlIGlmIChhcmdzLkFUVFJJQlVURSA9PT0gJ3VybCcpIHsNCiAgICAgICAgZW1iZWRzW2FyZ3MuRU1CRURdWyd1cmwnXSA9IGFyZ3MuU1RSSU5HOw0KICAgICAgfSBlbHNlIGlmIChhcmdzLkFUVFJJQlVURSA9PT0gJ3RodW1idXJsJykgew0KICAgICAgICBlbWJlZHNbYXJncy5FTUJFRF1bJ3RodW1ibmFpbCddWyd1cmwnXSA9IGFyZ3MuU1RSSU5HOw0KICAgICAgfSBlbHNlIGlmIChhcmdzLkFUVFJJQlVURSA9PT0gJ2ltYWdldXJsJykgew0KICAgICAgICBlbWJlZHNbYXJncy5FTUJFRF1bJ2ltYWdlJ11bJ3VybCddID0gYXJncy5TVFJJTkc7DQogICAgICB9DQogICAgICByZXR1cm4gJyc7DQogICAgfQ0KDQogICAgc2V0RW1iZWRDb2xvcihhcmdzKSB7DQogICAgICBpZiAoIWVtYmVkc1thcmdzLkVNQkVEXSkgew0KICAgICAgICByZXR1cm4gJyc7DQogICAgICB9DQogICAgICBsZXQgY29sb3IgPSBhcmdzLkNPTE9SOw0KICAgICAgY29sb3IgPSBjb2xvci5zdWJzdHJpbmcoMSwgNyk7DQogICAgICBjb2xvciA9IFNjcmF0Y2guQ2FzdC50b051bWJlcigiMHgiICsgY29sb3IpOw0KICAgICAgZW1iZWRzW2FyZ3MuRU1CRURdWydjb2xvciddID0gY29sb3I7DQogICAgfQ0KDQogICAgc2V0RW1iZWRBdXRob3IoYXJncykgew0KICAgICAgaWYgKCFlbWJlZHNbYXJncy5FTUJFRF0pIHsNCiAgICAgICAgcmV0dXJuICcnOw0KICAgICAgfQ0KICAgICAgaWYgKCFlbWJlZHNbYXJncy5FTUJFRF1bJ2F1dGhvciddKSB7DQogICAgICAgIGVtYmVkc1thcmdzLkVNQkVEXVsnYXV0aG9yJ10gPSB7Im5hbWUiOiAiQXV0aG9yIE5hbWUifTsNCiAgICAgIH0NCiAgICAgIGlmIChhcmdzLkFUVFJJQlVURSA9PT0gJ25hbWUnKSB7DQogICAgICAgIGVtYmVkc1thcmdzLkVNQkVEXVsnYXV0aG9yJ11bJ25hbWUnXSA9IGFyZ3MuU1RSSU5HOw0KICAgICAgfSBlbHNlIGlmIChhcmdzLkFUVFJJQlVURSA9PT0gJ3VybCcpIHsNCiAgICAgICAgZW1iZWRzW2FyZ3MuRU1CRURdWydhdXRob3InXVsndXJsJ10gPSBhcmdzLlNUUklORzsNCiAgICAgIH0gZWxzZSBpZiAoYXJncy5BVFRSSUJVVEUgPT09ICdpY29udXJsJykgew0KICAgICAgICBlbWJlZHNbYXJncy5FTUJFRF1bJ2F1dGhvciddWydpY29uX3VybCddID0gYXJncy5TVFJJTkc7DQogICAgICB9DQogICAgICByZXR1cm4gJyc7DQogICAgfQ0KDQogICAgZ2V0RW1iZWRBdHRyaWJ1dGUoYXJncykgew0KICAgICAgaWYgKCFlbWJlZHNbYXJncy5FTUJFRF0pIHsNCiAgICAgICAgcmV0dXJuICcnOw0KICAgICAgfQ0KICAgICAgaWYgKGFyZ3MuQVRUUklCVVRFID09PSAndGl0bGUnKSB7DQogICAgICAgIHJldHVybiBlbWJlZHNbYXJncy5FTUJFRF1bJ3RpdGxlJ107DQogICAgICB9IGVsc2UgaWYgKGFyZ3MuQVRUUklCVVRFID09PSAnZGVzY3JpcHRpb24nKSB7DQogICAgICAgIHJldHVybiBlbWJlZHNbYXJncy5FTUJFRF1bJ2Rlc2NyaXB0aW9uJ107DQogICAgICB9IGVsc2UgaWYgKGFyZ3MuQVRUUklCVVRFID09PSAndXJsJykgew0KICAgICAgICByZXR1cm4gZW1iZWRzW2FyZ3MuRU1CRURdWyd1cmwnXTsNCiAgICAgIH0NCiAgICB9DQoNCiAgICBjcmVhdGVXZWJob29rTWVudSgpIHsNCiAgICAgIGNvbnN0IHdlYmhvb2tNZW51ID0gW107DQogICAgICBjb25zdCBsZW5ndGggPSBPYmplY3Qua2V5cyh3ZWJob29rcykubGVuZ3RoOw0KICAgICAgZm9yIChsZXQgaW5kZXggPSAwOyBpbmRleCA8IGxlbmd0aDsgaW5kZXgrKykgew0KICAgICAgICBsZXQgbmFtZSA9IE9iamVjdC5rZXlzKHdlYmhvb2tzKVtpbmRleF07DQogICAgICAgIHdlYmhvb2tNZW51LnB1c2goew0KICAgICAgICAgIHRleHQ6IG5hbWUsDQogICAgICAgICAgdmFsdWU6IG5hbWUNCiAgICAgICAgfSk7DQogICAgICB9DQogICAgICBjb25zdCBuZXdXZWJob29rID0ge3RleHQ6ICdOZXcgd2ViaG9vaycsIHZhbHVlOiAoKSA9PiBjcmVhdGVOZXdXZWJob29rKCl9Ow0KICAgICAgaWYgKHdlYmhvb2tNZW51Lmxlbmd0aCA+IDApIHsNCiAgICAgICAgd2ViaG9va01lbnUucHVzaChuZXdXZWJob29rKTsNCiAgICAgICAgcmV0dXJuIHdlYmhvb2tNZW51Ow0KICAgICAgfSBlbHNlIHsNCiAgICAgICAgcmV0dXJuIFt7dGV4dDogJycsIHZhbHVlOiAnJ30sIG5ld1dlYmhvb2tdOw0KICAgICAgfQ0KICAgIH0NCg0KICAgIGNyZWF0ZUVtYmVkTWVudSgpIHsNCiAgICAgIGNvbnN0IGVtYmVkTWVudSA9IFtdOw0KICAgICAgY29uc3QgbGVuZ3RoID0gT2JqZWN0LmtleXMoZW1iZWRzKS5sZW5ndGg7DQogICAgICBmb3IgKGxldCBpbmRleCA9IDA7IGluZGV4IDwgbGVuZ3RoOyBpbmRleCsrKSB7DQogICAgICAgIGxldCBuYW1lID0gT2JqZWN0LmtleXMoZW1iZWRzKVtpbmRleF07DQogICAgICAgIGVtYmVkTWVudS5wdXNoKHsNCiAgICAgICAgICB0ZXh0OiBuYW1lLA0KICAgICAgICAgIHZhbHVlOiBuYW1lDQogICAgICAgIH0pOw0KICAgICAgfQ0KICAgICAgY29uc3QgbmV3RW1iZWQgPSB7dGV4dDogJ05ldyBlbWJlZCcsIHZhbHVlOiAoKSA9PiBjcmVhdGVOZXdFbWJlZCgpfTsNCiAgICAgIGNvbnN0IG5vRW1iZWQgPSB7dGV4dDogJ25vIGVtYmVkJywgdmFsdWU6ICdubyBlbWJlZCd9Ow0KICAgICAgaWYgKGVtYmVkTWVudS5sZW5ndGggPiAwKSB7DQogICAgICAgIGVtYmVkTWVudS5wdXNoKG5vRW1iZWQpOw0KICAgICAgICBlbWJlZE1lbnUucHVzaChuZXdFbWJlZCk7DQogICAgICAgIHJldHVybiBlbWJlZE1lbnU7DQogICAgICB9IGVsc2Ugew0KICAgICAgICByZXR1cm4gW25vRW1iZWQsIG5ld0VtYmVkXTsNCiAgICAgIH0NCiAgICB9DQogIH0NCg0KICBTY3JhdGNoLmV4dGVuc2lvbnMucmVnaXN0ZXIobmV3IERpc2NvcmRBUEkoKSk7DQp9KShTY3JhdGNoKTsNCg=="]) {
        vm.extensionManager.loadExtensionURL(extension);
      }

    } catch (e) {
      handleError(e);
    }
  </script>
  
  
    <script>
      const getProjectData = (function() {
        const storage = scaffolding.storage;
        storage.onprogress = (total, loaded) => {
          setProgress(interpolate(0.2, 0.98, loaded / total));
        };
        
        storage.addWebStore(
          [
            storage.AssetType.ImageVector,
            storage.AssetType.ImageBitmap,
            storage.AssetType.Sound,
            storage.AssetType.Font
          ].filter(i => i),
          (asset) => new URL('./assets/' + asset.assetId + '.' + asset.dataFormat, location).href
        );
        return () => new Promise((resolve, reject) => {
        const xhr = new XMLHttpRequest();
        xhr.onload = () => {
          resolve(xhr.response);
        };
        xhr.onerror = () => {
          if (location.protocol === 'file:') {
            reject(new Error('Zip environment must be used from a website, not from a file URL.'));
          } else {
            reject(new Error('Request to load project data failed.'));
          }
        };
        xhr.onprogress = (e) => {
          if (e.lengthComputable) {
            setProgress(interpolate(0.1, 0.2, e.loaded / e.total));
          }
        };
        xhr.responseType = 'arraybuffer';
        xhr.open('GET', "./assets/project.json");
        xhr.send();
      });
      })();
    </script>
  <script>
    const run = async () => {
      const projectData = await getProjectData();
      await scaffolding.loadProject(projectData);
      setProgress(1);
      loadingScreen.hidden = true;
      if (true) {
        scaffolding.start();
      } else {
        launchScreen.hidden = false;
        launchScreen.addEventListener('click', () => {
          launchScreen.hidden = true;
          scaffolding.start();
        });
        launchScreen.focus();
      }
    };
    run().catch(handleError);
  </script>
</body>
</html>
